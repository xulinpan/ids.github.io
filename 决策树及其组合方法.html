<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Chapter 8 决策树及其组合方法 | 数据科学导论（Introductory of Data Science）</title>
<meta name="author" content="潘蓄林">
<meta name="description" content="Decision Tree: A decision tree is a decision support tool that uses a tree-like graph or model of decisions and their possible consequences, including chance event outcomes, resource costs, and...">
<meta name="generator" content="bookdown 0.25 with bs4_book()">
<meta property="og:title" content="Chapter 8 决策树及其组合方法 | 数据科学导论（Introductory of Data Science）">
<meta property="og:type" content="book">
<meta property="og:description" content="Decision Tree: A decision tree is a decision support tool that uses a tree-like graph or model of decisions and their possible consequences, including chance event outcomes, resource costs, and...">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Chapter 8 决策树及其组合方法 | 数据科学导论（Introductory of Data Science）">
<meta name="twitter:description" content="Decision Tree: A decision tree is a decision support tool that uses a tree-like graph or model of decisions and their possible consequences, including chance event outcomes, resource costs, and...">
<!-- JS --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://kit.fontawesome.com/6ecbd6c532.js" crossorigin="anonymous"></script><script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="libs/bootstrap-4.6.0/bootstrap.min.css" rel="stylesheet">
<script src="libs/bootstrap-4.6.0/bootstrap.bundle.min.js"></script><script src="libs/bs3compat-0.3.1/transition.js"></script><script src="libs/bs3compat-0.3.1/tabs.js"></script><script src="libs/bs3compat-0.3.1/bs3compat.js"></script><link href="libs/bs4_book-1.0.0/bs4_book.css" rel="stylesheet">
<script src="libs/bs4_book-1.0.0/bs4_book.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- CSS --><style type="text/css">
    
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  </style>
</head>
<body data-spy="scroll" data-target="#toc">

<div class="container-fluid">
<div class="row">
  <header class="col-sm-12 col-lg-3 sidebar sidebar-book"><a class="sr-only sr-only-focusable" href="#content">Skip to main content</a>

    <div class="d-flex align-items-start justify-content-between">
      <h1>
        <a href="index.html" title="">数据科学导论（Introductory of Data Science）</a>
      </h1>
      <button class="btn btn-outline-primary d-lg-none ml-2 mt-1" type="button" data-toggle="collapse" data-target="#main-nav" aria-expanded="true" aria-controls="main-nav"><i class="fas fa-bars"></i><span class="sr-only">Show table of contents</span></button>
    </div>

    <div id="main-nav" class="collapse-lg">
      <form role="search">
        <input id="search" class="form-control" type="search" placeholder="Search" aria-label="Search">
</form>

      <nav aria-label="Table of contents"><h2>Table of contents</h2>
        <ul class="book-toc list-unstyled">
<li><a class="" href="index.html"><span class="header-section-number">1</span> 前言（Prerequisites）</a></li>
<li><a class="" href="r%E5%8F%8Apython%E8%AF%AD%E8%A8%80%E7%AE%80%E4%BB%8B.html"><span class="header-section-number">2</span> R及Python语言简介</a></li>
<li><a class="" href="%E6%95%B0%E6%8D%AE%E6%8F%8F%E8%BF%B0.html"><span class="header-section-number">3</span> 数据描述</a></li>
<li><a class="" href="%E6%95%B0%E6%8D%AE%E6%95%B4%E7%90%86%E5%92%8C%E6%B8%85%E7%90%86.html"><span class="header-section-number">4</span> 数据整理和清理</a></li>
<li><a class="" href="%E6%9C%89%E7%9B%91%E7%9D%A3%E5%AD%A6%E4%B9%A0%E6%A6%82%E8%AE%BA.html"><span class="header-section-number">5</span> 有监督学习概论</a></li>
<li><a class="" href="%E6%9C%80%E5%B0%8F%E4%BA%8C%E4%B9%98%E7%BA%BF%E6%80%A7%E5%9B%9E%E5%BD%92%E6%B3%95.html"><span class="header-section-number">6</span> 最小二乘线性回归法</a></li>
<li><a class="" href="logistic%E5%9B%9E%E5%BD%92.html"><span class="header-section-number">7</span> Logistic回归</a></li>
<li><a class="active" href="%E5%86%B3%E7%AD%96%E6%A0%91%E5%8F%8A%E5%85%B6%E7%BB%84%E5%90%88%E6%96%B9%E6%B3%95.html"><span class="header-section-number">8</span> 决策树及其组合方法</a></li>
<li><a class="" href="github%E4%BD%BF%E7%94%A8.html"><span class="header-section-number">9</span> github使用</a></li>
<li><a class="" href="references.html">References</a></li>
</ul>

        <div class="book-extra">
          
        </div>
      </nav>
</div>
  </header><main class="col-sm-12 col-md-9 col-lg-7" id="content"><div id="决策树及其组合方法" class="section level1" number="8">
<h1>
<span class="header-section-number">8</span> 决策树及其组合方法<a class="anchor" aria-label="anchor" href="#%E5%86%B3%E7%AD%96%E6%A0%91%E5%8F%8A%E5%85%B6%E7%BB%84%E5%90%88%E6%96%B9%E6%B3%95"><i class="fas fa-link"></i></a>
</h1>
<ul>
<li><p>Decision Tree: A decision tree is a decision support tool that uses a tree-like graph or model of decisions and their possible consequences, including chance event outcomes, resource costs, and utility.</p></li>
<li><p>Decision trees are produced by algorithms that identify various ways of splitting a data set into branch-like segments. These segments form an inverted decision tree that originates with a root node at the top of the tree.</p></li>
</ul>
<div id="决策树" class="section level2" number="8.1">
<h2>
<span class="header-section-number">8.1</span> 决策树<a class="anchor" aria-label="anchor" href="#%E5%86%B3%E7%AD%96%E6%A0%91"><i class="fas fa-link"></i></a>
</h2>
</div>
<div id="实例-1" class="section level2" number="8.2">
<h2>
<span class="header-section-number">8.2</span> 实例<a class="anchor" aria-label="anchor" href="#%E5%AE%9E%E4%BE%8B-1"><i class="fas fa-link"></i></a>
</h2>
<div class="sourceCode" id="cb613"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">#####</span>
<span class="co"># importing churn data set from .csv file</span>
<span class="va">data1</span> <span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/utils/read.table.html">read.csv</a></span><span class="op">(</span><span class="st">"./data/chun_data.csv"</span>,header<span class="op">=</span> <span class="cn">TRUE</span>,sep<span class="op">=</span><span class="st">","</span><span class="op">)</span>

<span class="co">#as the first three columns of the data arent important for the prediction we drop those columns from the data frame </span>
<span class="co"># drop the variables from the data set</span>
<span class="va">data1</span><span class="op">&lt;-</span><span class="va">data1</span><span class="op">[</span><span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span>,<span class="fl">3</span><span class="op">)</span><span class="op">]</span>

<span class="co">#data exploration</span>

<span class="co">#gives the dimensions of the data set</span>
<span class="fu"><a href="https://rdrr.io/r/base/dim.html">dim</a></span><span class="op">(</span><span class="va">data1</span><span class="op">)</span></code></pre></div>
<pre><code>## [1] 5000   17</code></pre>
<div class="sourceCode" id="cb615"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">#gives the names of the variables in the data set</span>
<span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">data1</span><span class="op">)</span></code></pre></div>
<pre><code>##  [1] "international_plan"            "voice_mail_plan"              
##  [3] "number_vmail_messages"         "total_day_minutes"            
##  [5] "total_day_calls"               "total_day_charge"             
##  [7] "total_eve_minutes"             "total_eve_calls"              
##  [9] "total_eve_charge"              "total_night_minutes"          
## [11] "total_night_calls"             "total_night_charge"           
## [13] "total_intl_minutes"            "total_intl_calls"             
## [15] "total_intl_charge"             "number_customer_service_calls"
## [17] "churn"</code></pre>
<div class="sourceCode" id="cb617"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">#displays top 10 observations of the data set</span>
<span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">data1</span><span class="op">)</span></code></pre></div>
<pre><code>##   international_plan voice_mail_plan number_vmail_messages total_day_minutes
## 1                 no             yes                    25             265.1
## 2                 no             yes                    26             161.6
## 3                 no              no                     0             243.4
## 4                yes              no                     0             299.4
## 5                yes              no                     0             166.7
## 6                yes              no                     0             223.4
##   total_day_calls total_day_charge total_eve_minutes total_eve_calls
## 1             110            45.07             197.4              99
## 2             123            27.47             195.5             103
## 3             114            41.38             121.2             110
## 4              71            50.90              61.9              88
## 5             113            28.34             148.3             122
## 6              98            37.98             220.6             101
##   total_eve_charge total_night_minutes total_night_calls total_night_charge
## 1            16.78               244.7                91              11.01
## 2            16.62               254.4               103              11.45
## 3            10.30               162.6               104               7.32
## 4             5.26               196.9                89               8.86
## 5            12.61               186.9               121               8.41
## 6            18.75               203.9               118               9.18
##   total_intl_minutes total_intl_calls total_intl_charge
## 1               10.0                3              2.70
## 2               13.7                3              3.70
## 3               12.2                5              3.29
## 4                6.6                7              1.78
## 5               10.1                3              2.73
## 6                6.3                6              1.70
##   number_customer_service_calls churn
## 1                             1    no
## 2                             1    no
## 3                             0    no
## 4                             2    no
## 5                             3    no
## 6                             0    no</code></pre>
<div class="sourceCode" id="cb619"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">#displays bottom top 10 observations of the data set</span>
<span class="fu"><a href="https://rdrr.io/r/utils/head.html">tail</a></span><span class="op">(</span><span class="va">data1</span><span class="op">)</span></code></pre></div>
<pre><code>##      international_plan voice_mail_plan number_vmail_messages total_day_minutes
## 4995                 no              no                     0             170.7
## 4996                 no             yes                    40             235.7
## 4997                 no              no                     0             184.2
## 4998                 no              no                     0             140.6
## 4999                 no              no                     0             188.8
## 5000                 no             yes                    34             129.4
##      total_day_calls total_day_charge total_eve_minutes total_eve_calls
## 4995             101            29.02             193.1             126
## 4996             127            40.07             223.0             126
## 4997              90            31.31             256.8              73
## 4998              89            23.90             172.8             128
## 4999              67            32.10             171.7              92
## 5000             102            22.00             267.1             104
##      total_eve_charge total_night_minutes total_night_calls total_night_charge
## 4995            16.41               129.1               104               5.81
## 4996            18.96               297.5               116              13.39
## 4997            21.83               213.6               113               9.61
## 4998            14.69               212.4                97               9.56
## 4999            14.59               224.4                89              10.10
## 5000            22.70               154.8               100               6.97
##      total_intl_minutes total_intl_calls total_intl_charge
## 4995                6.9                7              1.86
## 4996                9.9                5              2.67
## 4997               14.7                2              3.97
## 4998               13.6                4              3.67
## 4999                8.5                6              2.30
## 5000                9.3               16              2.51
##      number_customer_service_calls churn
## 4995                             1    no
## 4996                             2    no
## 4997                             3   yes
## 4998                             1    no
## 4999                             0    no
## 5000                             0    no</code></pre>
<div class="sourceCode" id="cb621"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">#displays structure of the variables in the data set</span>
<span class="fu"><a href="https://rdrr.io/r/utils/str.html">str</a></span><span class="op">(</span><span class="va">data1</span><span class="op">)</span></code></pre></div>
<pre><code>## 'data.frame':    5000 obs. of  17 variables:
##  $ international_plan           : chr  "no" "no" "no" "yes" ...
##  $ voice_mail_plan              : chr  "yes" "yes" "no" "no" ...
##  $ number_vmail_messages        : int  25 26 0 0 0 0 24 0 0 37 ...
##  $ total_day_minutes            : num  265 162 243 299 167 ...
##  $ total_day_calls              : int  110 123 114 71 113 98 88 79 97 84 ...
##  $ total_day_charge             : num  45.1 27.5 41.4 50.9 28.3 ...
##  $ total_eve_minutes            : num  197.4 195.5 121.2 61.9 148.3 ...
##  $ total_eve_calls              : int  99 103 110 88 122 101 108 94 80 111 ...
##  $ total_eve_charge             : num  16.78 16.62 10.3 5.26 12.61 ...
##  $ total_night_minutes          : num  245 254 163 197 187 ...
##  $ total_night_calls            : int  91 103 104 89 121 118 118 96 90 97 ...
##  $ total_night_charge           : num  11.01 11.45 7.32 8.86 8.41 ...
##  $ total_intl_minutes           : num  10 13.7 12.2 6.6 10.1 6.3 7.5 7.1 8.7 11.2 ...
##  $ total_intl_calls             : int  3 3 5 7 3 6 7 6 4 5 ...
##  $ total_intl_charge            : num  2.7 3.7 3.29 1.78 2.73 1.7 2.03 1.92 2.35 3.02 ...
##  $ number_customer_service_calls: int  1 1 0 2 3 0 3 0 1 0 ...
##  $ churn                        : chr  "no" "no" "no" "no" ...</code></pre>
<div class="sourceCode" id="cb623"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">#gives the summary of the variables of the data set </span>
<span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">data1</span><span class="op">)</span></code></pre></div>
<pre><code>##  international_plan voice_mail_plan    number_vmail_messages total_day_minutes
##  Length:5000        Length:5000        Min.   : 0.000        Min.   :  0.0    
##  Class :character   Class :character   1st Qu.: 0.000        1st Qu.:143.7    
##  Mode  :character   Mode  :character   Median : 0.000        Median :180.1    
##                                        Mean   : 7.755        Mean   :180.3    
##                                        3rd Qu.:17.000        3rd Qu.:216.2    
##                                        Max.   :52.000        Max.   :351.5    
##  total_day_calls total_day_charge total_eve_minutes total_eve_calls
##  Min.   :  0     Min.   : 0.00    Min.   :  0.0     Min.   :  0.0  
##  1st Qu.: 87     1st Qu.:24.43    1st Qu.:166.4     1st Qu.: 87.0  
##  Median :100     Median :30.62    Median :201.0     Median :100.0  
##  Mean   :100     Mean   :30.65    Mean   :200.6     Mean   :100.2  
##  3rd Qu.:113     3rd Qu.:36.75    3rd Qu.:234.1     3rd Qu.:114.0  
##  Max.   :165     Max.   :59.76    Max.   :363.7     Max.   :170.0  
##  total_eve_charge total_night_minutes total_night_calls total_night_charge
##  Min.   : 0.00    Min.   :  0.0       Min.   :  0.00    Min.   : 0.000    
##  1st Qu.:14.14    1st Qu.:166.9       1st Qu.: 87.00    1st Qu.: 7.510    
##  Median :17.09    Median :200.4       Median :100.00    Median : 9.020    
##  Mean   :17.05    Mean   :200.4       Mean   : 99.92    Mean   : 9.018    
##  3rd Qu.:19.90    3rd Qu.:234.7       3rd Qu.:113.00    3rd Qu.:10.560    
##  Max.   :30.91    Max.   :395.0       Max.   :175.00    Max.   :17.770    
##  total_intl_minutes total_intl_calls total_intl_charge
##  Min.   : 0.00      Min.   : 0.000   Min.   :0.000    
##  1st Qu.: 8.50      1st Qu.: 3.000   1st Qu.:2.300    
##  Median :10.30      Median : 4.000   Median :2.780    
##  Mean   :10.26      Mean   : 4.435   Mean   :2.771    
##  3rd Qu.:12.00      3rd Qu.: 6.000   3rd Qu.:3.240    
##  Max.   :20.00      Max.   :20.000   Max.   :5.400    
##  number_customer_service_calls    churn          
##  Min.   :0.00                  Length:5000       
##  1st Qu.:1.00                  Class :character  
##  Median :1.00                  Mode  :character  
##  Mean   :1.57                                    
##  3rd Qu.:2.00                                    
##  Max.   :9.00</code></pre>
<div class="sourceCode" id="cb625"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">#library for the sample.split function</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">caTools</span><span class="op">)</span>

<span class="co">#splitting the data into training and testing data </span>
<span class="co"># sample the input data with 70% for training and 30% for testing</span>
<span class="va">data1</span><span class="op">$</span><span class="va">churn</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="va">data1</span><span class="op">$</span><span class="va">churn</span><span class="op">)</span>
<span class="va">sample</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/caTools/man/sample.split.html">sample.split</a></span><span class="op">(</span><span class="va">data1</span><span class="op">$</span><span class="va">churn</span>,SplitRatio<span class="op">=</span><span class="fl">0.70</span><span class="op">)</span>

<span class="va">trainData</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/subset.data.table.html">subset</a></span><span class="op">(</span><span class="va">data1</span>,<span class="va">sample</span><span class="op">==</span><span class="cn">TRUE</span><span class="op">)</span>

<span class="va">testData</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/subset.data.table.html">subset</a></span><span class="op">(</span><span class="va">data1</span>,<span class="va">sample</span><span class="op">==</span><span class="cn">FALSE</span><span class="op">)</span>

<span class="co">#rpart --- recursive partitioning decision tree</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/bethatkinson/rpart">rpart</a></span><span class="op">)</span>

<span class="co">#TO BUILD DECISON TREE BY USING RPART PACKAGE(recursive partitioning decision tree)</span>
<span class="va">churn_model</span><span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/rpart/man/rpart.html">rpart</a></span><span class="op">(</span><span class="va">churn</span> <span class="op">~</span> <span class="va">.</span>,data<span class="op">=</span><span class="va">trainData</span><span class="op">)</span>
<span class="va">churn_model</span></code></pre></div>
<pre><code>## n= 3500 
## 
## node), split, n, loss, yval, (yprob)
##       * denotes terminal node
## 
##   1) root 3500 495 no (0.85857143 0.14142857)  
##     2) total_day_minutes&lt; 264.65 3293 369 no (0.88794412 0.11205588)  
##       4) number_customer_service_calls&lt; 3.5 3020 236 no (0.92185430 0.07814570)  
##         8) international_plan=no 2740 131 no (0.95218978 0.04781022)  
##          16) total_day_minutes&lt; 245.15 2594  91 no (0.96491904 0.03508096)  
##            32) total_day_minutes&lt; 221.85 2318  61 no (0.97368421 0.02631579) *
##            33) total_day_minutes&gt;=221.85 276  30 no (0.89130435 0.10869565)  
##              66) total_eve_minutes&lt; 267.15 254  14 no (0.94488189 0.05511811) *
##              67) total_eve_minutes&gt;=267.15 22   6 yes (0.27272727 0.72727273) *
##          17) total_day_minutes&gt;=245.15 146  40 no (0.72602740 0.27397260)  
##            34) total_eve_minutes&lt; 205.6 81   3 no (0.96296296 0.03703704) *
##            35) total_eve_minutes&gt;=205.6 65  28 yes (0.43076923 0.56923077)  
##              70) voice_mail_plan=yes 17   1 no (0.94117647 0.05882353) *
##              71) voice_mail_plan=no 48  12 yes (0.25000000 0.75000000)  
##               142) total_night_minutes&lt; 169.8 14   4 no (0.71428571 0.28571429) *
##               143) total_night_minutes&gt;=169.8 34   2 yes (0.05882353 0.94117647) *
##         9) international_plan=yes 280 105 no (0.62500000 0.37500000)  
##          18) total_intl_calls&gt;=2.5 227  52 no (0.77092511 0.22907489)  
##            36) total_intl_minutes&lt; 13.05 179   4 no (0.97765363 0.02234637) *
##            37) total_intl_minutes&gt;=13.05 48   0 yes (0.00000000 1.00000000) *
##          19) total_intl_calls&lt; 2.5 53   0 yes (0.00000000 1.00000000) *
##       5) number_customer_service_calls&gt;=3.5 273 133 no (0.51282051 0.48717949)  
##        10) total_day_minutes&gt;=160.25 163  37 no (0.77300613 0.22699387)  
##          20) total_eve_minutes&gt;=155.55 134  20 no (0.85074627 0.14925373) *
##          21) total_eve_minutes&lt; 155.55 29  12 yes (0.41379310 0.58620690)  
##            42) total_day_minutes&gt;=197.2 17   6 no (0.64705882 0.35294118) *
##            43) total_day_minutes&lt; 197.2 12   1 yes (0.08333333 0.91666667) *
##        11) total_day_minutes&lt; 160.25 110  14 yes (0.12727273 0.87272727) *
##     3) total_day_minutes&gt;=264.65 207  81 yes (0.39130435 0.60869565)  
##       6) voice_mail_plan=yes 44   4 no (0.90909091 0.09090909) *
##       7) voice_mail_plan=no 163  41 yes (0.25153374 0.74846626)  
##        14) total_eve_minutes&lt; 155.6 33   6 no (0.81818182 0.18181818) *
##        15) total_eve_minutes&gt;=155.6 130  14 yes (0.10769231 0.89230769) *</code></pre>
<div class="sourceCode" id="cb627"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">#to display it in diagram</span>

<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://rattle.togaware.com/">rattle</a></span><span class="op">)</span></code></pre></div>
<pre><code>## Loading required package: tibble</code></pre>
<pre><code>## Loading required package: bitops</code></pre>
<pre><code>## Rattle: A free graphical interface for data science with R.
## Version 5.5.1 Copyright (c) 2006-2021 Togaware Pty Ltd.
## Type 'rattle()' to shake, rattle, and roll your data.</code></pre>
<div class="sourceCode" id="cb631"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="http://www.milbo.org/rpart-plot/index.html">rpart.plot</a></span><span class="op">)</span>

<span class="fu"><a href="https://rdrr.io/pkg/rattle/man/fancyRpartPlot.html">fancyRpartPlot</a></span><span class="op">(</span><span class="va">churn_model</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="07-decisiontree_files/figure-html/project-1.png" width="672"></div>
<div class="sourceCode" id="cb632"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">#predicting the model data based on the model built from training data set</span>
<span class="va">pred</span><span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span><span class="op">(</span><span class="va">churn_model</span>,<span class="va">testData</span>,type <span class="op">=</span> <span class="st">"class"</span> <span class="op">)</span>
<span class="va">pred</span></code></pre></div>
<pre><code>##    2    3    6    7   11   16   19   20   24   36   41   42   45   49   51   53 
##   no   no   no   no  yes  yes   no   no   no   no   no  yes   no  yes   no   no 
##   54   57   59   64   67   70   71   72   73   76   80   88   90   91   93   94 
##   no   no   no   no   no   no   no   no   no   no   no   no   no   no   no   no 
##  105  106  109  110  113  115  119  120  122  123  127  128  129  131  132  134 
##   no   no   no   no   no   no   no   no   no   no  yes  yes   no   no   no   no 
##  147  150  151  154  155  156  160  162  163  171  172  175  179  181  187  194 
##   no   no   no   no   no   no   no   no   no   no   no   no   no   no   no   no 
##  195  196  199  200  201  202  203  205  208  209  216  220  226  228  235  237 
##   no   no   no   no   no   no   no   no   no   no   no   no   no   no   no   no 
##  244  251  253  256  257  258  260  267  268  271  272  276  278  280  281  285 
##   no  yes   no   no   no   no   no   no   no   no   no   no   no   no   no   no 
##  286  290  300  302  306  307  316  319  320  322  330  342  347  350  355  356 
##   no  yes   no  yes   no  yes   no   no  yes   no   no   no   no  yes  yes   no 
##  360  364  366  374  379  380  381  390  391  392  394  396  398  400  403  404 
##   no   no  yes   no  yes   no   no   no   no   no   no   no  yes   no   no   no 
##  405  412  416  421  422  426  428  429  433  434  436  441  442  443  449  452 
##   no   no  yes   no   no   no   no   no   no   no   no   no   no   no   no   no 
##  457  458  462  470  478  480  483  487  489  490  491  496  506  508  515  516 
##   no   no   no   no   no   no   no   no   no   no   no   no   no   no   no   no 
##  519  522  524  525  527  529  530  533  535  538  539  546  550  553  563  566 
##   no  yes   no   no   no   no   no   no   no   no   no   no   no  yes   no   no 
##  568  569  575  578  581  583  584  586  590  593  594  597  598  601  608  609 
##   no  yes  yes   no   no   no   no   no   no   no   no   no   no   no   no   no 
##  610  612  617  620  621  625  627  630  632  635  637  640  654  656  659  662 
##   no   no   no  yes   no   no  yes  yes   no   no   no   no   no  yes   no   no 
##  675  676  678  684  688  690  696  697  702  703  708  709  714  719  724  729 
##   no   no   no   no   no   no   no   no   no   no   no   no   no   no   no   no 
##  732  734  735  749  753  757  760  761  762  766  767  771  778  783  785  787 
##   no   no   no   no   no   no   no   no   no   no  yes   no   no   no   no   no 
##  798  801  805  806  807  808  813  817  820  821  822  834  835  838  841  842 
##  yes   no  yes   no   no   no   no   no   no   no   no   no   no   no   no   no 
##  852  853  854  855  863  865  868  872  873  877  881  893  894  896  899  901 
##   no   no   no   no   no   no   no  yes   no   no   no   no   no   no   no   no 
##  903  904  917  920  921  927  931  938  940  941  942  945  946  948  949  957 
##   no   no   no   no   no   no   no   no   no   no   no   no   no   no   no   no 
##  964  966  970  974  980  981  987  991  992  994  995 1002 1003 1004 1006 1007 
##   no   no   no   no   no   no   no   no   no   no   no   no   no   no   no   no 
## 1022 1025 1033 1035 1036 1040 1044 1056 1058 1061 1062 1065 1067 1080 1082 1084 
##   no   no   no   no   no   no   no   no   no   no   no   no   no   no   no   no 
## 1089 1092 1093 1096 1097 1098 1099 1104 1109 1113 1114 1117 1119 1124 1128 1129 
##   no   no   no  yes   no   no   no   no   no   no   no   no   no   no   no   no 
## 1130 1131 1132 1133 1136 1137 1142 1143 1145 1147 1148 1150 1151 1157 1159 1164 
##   no   no   no   no   no   no   no  yes   no   no   no   no  yes   no   no   no 
## 1166 1172 1173 1174 1176 1180 1183 1188 1197 1198 1202 1203 1207 1209 1211 1217 
##   no   no   no   no   no   no  yes   no   no   no   no   no   no   no  yes   no 
## 1218 1222 1230 1231 1232 1233 1240 1244 1245 1247 1250 1251 1252 1254 1257 1258 
##   no   no   no   no  yes   no   no   no   no   no   no   no   no   no   no   no 
## 1262 1264 1266 1273 1280 1283 1287 1288 1289 1290 1295 1296 1303 1304 1309 1310 
##   no   no   no   no   no   no   no   no   no   no   no   no  yes   no   no   no 
## 1311 1313 1314 1315 1320 1324 1327 1328 1332 1333 1334 1336 1337 1338 1341 1345 
##   no   no   no   no   no   no   no   no   no   no   no   no  yes  yes   no  yes 
## 1346 1348 1350 1351 1354 1360 1362 1364 1365 1367 1370 1372 1373 1377 1380 1383 
##  yes   no   no  yes   no   no   no   no   no   no   no   no   no   no   no  yes 
## 1384 1386 1387 1389 1392 1393 1395 1396 1398 1402 1404 1405 1410 1415 1417 1419 
##   no   no   no   no   no  yes  yes   no   no   no   no   no   no   no   no   no 
## 1422 1423 1425 1432 1434 1436 1442 1447 1449 1453 1464 1467 1473 1480 1481 1484 
##   no   no   no   no   no  yes   no   no   no   no   no   no  yes   no   no   no 
## 1493 1496 1500 1508 1509 1510 1513 1514 1517 1518 1524 1536 1538 1539 1541 1543 
##   no   no   no   no   no   no   no   no   no   no   no   no  yes  yes   no   no 
## 1546 1549 1551 1552 1553 1563 1565 1567 1570 1571 1572 1573 1586 1593 1594 1596 
##   no  yes   no   no   no   no   no   no   no   no   no   no   no   no  yes   no 
## 1597 1598 1608 1613 1614 1616 1617 1622 1623 1625 1626 1628 1631 1633 1640 1642 
##   no   no   no   no   no   no   no   no   no   no  yes   no   no   no   no   no 
## 1651 1653 1657 1659 1660 1664 1665 1669 1670 1673 1675 1679 1686 1692 1697 1698 
##   no   no   no   no   no   no   no   no   no   no  yes   no   no  yes   no   no 
## 1699 1700 1701 1707 1708 1715 1717 1718 1719 1729 1733 1737 1744 1745 1750 1755 
##   no   no   no   no  yes   no   no   no   no  yes   no  yes   no   no   no  yes 
## 1756 1760 1762 1763 1764 1766 1778 1780 1785 1788 1791 1795 1801 1802 1807 1813 
##   no   no   no   no   no  yes   no   no  yes   no   no  yes   no   no   no  yes 
## 1820 1822 1828 1830 1831 1832 1834 1835 1836 1840 1847 1851 1852 1854 1857 1858 
##   no   no   no   no  yes  yes   no   no   no   no   no   no   no   no   no  yes 
## 1860 1866 1868 1874 1875 1878 1882 1884 1885 1888 1893 1894 1896 1897 1898 1900 
##   no  yes   no   no   no   no  yes   no   no  yes  yes  yes   no   no   no   no 
## 1923 1927 1928 1930 1932 1936 1941 1947 1948 1956 1962 1963 1968 1970 1971 1974 
##   no   no   no   no   no  yes   no   no   no   no   no   no   no   no   no   no 
## 1978 1982 1985 1991 1992 1995 1997 2000 2007 2025 2029 2038 2043 2051 2052 2053 
##  yes   no  yes   no   no   no   no   no   no   no   no   no   no   no  yes   no 
## 2054 2056 2057 2058 2062 2066 2070 2071 2077 2081 2082 2085 2086 2087 2090 2097 
##   no   no   no   no   no   no  yes   no   no   no   no   no   no   no   no   no 
## 2100 2103 2105 2107 2110 2121 2122 2124 2131 2140 2143 2144 2149 2150 2160 2161 
##  yes  yes   no  yes   no   no   no   no   no   no   no   no   no   no   no  yes 
## 2164 2166 2168 2172 2176 2178 2180 2183 2185 2188 2191 2193 2194 2195 2201 2202 
##   no   no   no   no   no   no   no   no   no   no   no   no  yes   no   no   no 
## 2205 2206 2208 2219 2225 2226 2228 2230 2239 2241 2242 2247 2249 2252 2254 2255 
##   no   no   no  yes   no   no   no   no  yes   no   no   no   no   no   no   no 
## 2256 2258 2262 2266 2269 2275 2276 2277 2279 2283 2288 2289 2291 2292 2293 2294 
##   no   no   no   no   no   no   no   no   no   no   no   no  yes   no   no   no 
## 2297 2298 2302 2303 2308 2311 2312 2315 2317 2318 2321 2330 2336 2339 2342 2346 
##   no   no   no   no   no   no   no   no   no   no   no   no  yes   no   no   no 
## 2350 2353 2354 2357 2361 2374 2380 2382 2388 2392 2398 2400 2402 2409 2410 2417 
##   no   no   no  yes   no   no   no   no   no   no  yes   no  yes   no   no   no 
## 2418 2425 2427 2428 2431 2443 2444 2447 2451 2452 2454 2457 2458 2461 2470 2471 
##   no   no   no   no   no   no   no   no   no  yes   no   no   no   no   no   no 
## 2473 2478 2479 2481 2482 2483 2484 2486 2489 2490 2493 2498 2500 2503 2505 2506 
##   no   no   no   no   no   no   no   no   no   no   no   no   no   no   no   no 
## 2511 2512 2517 2519 2520 2524 2525 2532 2534 2535 2536 2537 2547 2552 2559 2560 
##   no   no   no   no   no   no   no   no   no   no   no  yes   no   no   no   no 
## 2567 2568 2569 2577 2581 2584 2590 2593 2594 2596 2598 2600 2604 2608 2611 2613 
##   no   no   no   no   no   no   no   no   no  yes   no  yes   no   no   no   no 
## 2619 2620 2627 2635 2637 2638 2640 2644 2650 2651 2652 2653 2657 2660 2664 2665 
##   no  yes   no   no   no   no   no   no   no   no   no   no   no   no   no  yes 
## 2669 2670 2671 2673 2676 2678 2681 2682 2683 2697 2699 2700 2701 2703 2704 2707 
##   no   no   no  yes   no   no   no   no   no  yes   no   no  yes   no   no   no 
## 2711 2712 2713 2720 2724 2727 2733 2734 2739 2740 2751 2761 2762 2767 2770 2772 
##  yes   no   no   no   no   no   no   no   no   no   no  yes   no   no   no   no 
## 2775 2781 2782 2786 2788 2792 2793 2795 2807 2809 2810 2819 2821 2823 2826 2827 
##  yes   no   no   no   no   no   no   no   no   no   no   no  yes   no   no   no 
## 2830 2834 2842 2843 2850 2854 2855 2859 2861 2874 2876 2877 2879 2884 2889 2890 
##   no  yes   no   no   no   no   no   no   no   no   no   no   no   no   no  yes 
## 2892 2893 2894 2898 2899 2900 2901 2903 2911 2915 2922 2926 2929 2931 2933 2934 
##   no   no   no   no   no   no   no   no   no   no   no   no   no   no   no   no 
## 2936 2939 2940 2941 2953 2956 2958 2959 2969 2974 2978 2980 2981 2983 2985 2988 
##   no   no   no   no   no   no   no  yes  yes   no   no  yes  yes   no   no  yes 
## 2993 2995 2996 2999 3005 3006 3007 3016 3017 3024 3031 3032 3033 3034 3036 3037 
##   no  yes   no   no   no   no   no   no   no  yes   no   no   no   no  yes   no 
## 3038 3039 3042 3045 3046 3049 3055 3056 3059 3066 3067 3072 3077 3080 3082 3083 
##   no   no   no   no  yes   no   no   no   no   no   no   no   no  yes   no   no 
## 3086 3091 3092 3094 3097 3099 3101 3103 3106 3108 3111 3118 3126 3130 3131 3138 
##   no   no   no  yes   no   no   no   no   no   no   no   no  yes   no   no   no 
## 3139 3142 3143 3148 3149 3150 3157 3159 3164 3173 3174 3177 3178 3179 3182 3184 
##   no   no   no   no  yes   no   no   no  yes   no   no   no   no   no   no   no 
## 3188 3189 3193 3200 3205 3206 3210 3214 3215 3225 3226 3227 3228 3229 3230 3232 
##   no   no   no   no   no  yes  yes   no   no  yes   no   no   no   no   no   no 
## 3233 3240 3244 3249 3251 3263 3274 3275 3277 3279 3282 3284 3285 3287 3290 3296 
##   no   no  yes   no   no   no   no   no   no   no   no   no   no   no   no   no 
## 3298 3299 3307 3308 3309 3310 3312 3319 3320 3324 3328 3330 3338 3339 3340 3341 
##   no   no   no   no   no   no   no   no   no  yes   no   no   no   no   no   no 
## 3349 3352 3353 3354 3355 3364 3368 3371 3377 3381 3385 3403 3404 3405 3406 3413 
##   no   no   no   no   no   no   no   no   no   no   no   no   no   no   no   no 
## 3415 3418 3419 3423 3431 3434 3435 3440 3446 3449 3450 3455 3456 3458 3461 3463 
##   no   no   no   no   no   no   no   no   no   no   no   no   no  yes   no   no 
## 3466 3476 3484 3506 3508 3514 3522 3530 3541 3546 3549 3550 3551 3565 3567 3568 
##   no   no   no   no   no   no   no   no  yes   no  yes  yes   no   no   no   no 
## 3569 3570 3573 3574 3582 3583 3585 3586 3588 3590 3598 3602 3617 3618 3620 3621 
##   no   no   no   no   no   no   no  yes  yes   no   no   no  yes  yes   no   no 
## 3628 3635 3636 3640 3641 3644 3645 3652 3653 3654 3662 3663 3664 3671 3672 3673 
##   no   no   no   no   no   no   no   no   no   no   no   no   no   no   no   no 
## 3675 3682 3684 3686 3689 3691 3692 3695 3697 3698 3702 3705 3709 3714 3715 3718 
##   no  yes   no   no  yes   no   no   no   no   no   no   no   no   no   no  yes 
## 3719 3720 3721 3724 3741 3743 3744 3749 3750 3752 3757 3759 3765 3768 3770 3774 
##   no   no   no   no   no   no   no   no   no   no   no   no   no   no   no   no 
## 3777 3781 3782 3783 3784 3787 3789 3793 3795 3796 3798 3805 3810 3812 3814 3817 
##   no   no   no   no   no   no   no   no   no   no   no   no   no   no   no   no 
## 3818 3820 3822 3825 3827 3837 3838 3842 3846 3847 3848 3849 3853 3854 3860 3863 
##   no   no   no   no   no   no   no   no   no   no  yes   no  yes   no   no   no 
## 3868 3869 3871 3874 3875 3877 3880 3886 3890 3900 3902 3904 3909 3911 3913 3914 
##   no  yes   no   no   no   no   no   no   no   no  yes   no   no   no   no   no 
## 3916 3921 3925 3927 3931 3933 3940 3941 3942 3944 3955 3956 3958 3959 3963 3967 
##   no   no   no   no   no   no   no   no   no   no   no   no   no   no   no  yes 
## 3971 3976 3979 3981 3985 3989 3993 3995 3998 3999 4002 4003 4005 4011 4015 4016 
##   no   no  yes   no   no   no   no   no   no   no   no  yes   no   no   no   no 
## 4017 4021 4028 4031 4034 4040 4047 4050 4051 4054 4057 4062 4064 4068 4071 4072 
##   no   no   no  yes   no   no   no   no   no  yes   no   no   no   no   no   no 
## 4073 4077 4082 4083 4092 4093 4098 4102 4103 4107 4108 4112 4113 4114 4116 4119 
##   no   no   no   no   no   no   no   no   no   no   no   no   no   no   no   no 
## 4120 4125 4126 4127 4131 4139 4146 4147 4154 4158 4160 4161 4162 4166 4169 4173 
##   no   no   no   no  yes   no   no   no   no   no   no   no   no  yes   no   no 
## 4175 4177 4181 4183 4184 4186 4187 4188 4192 4193 4194 4195 4201 4204 4216 4217 
##   no   no   no   no   no   no   no   no   no   no   no   no   no   no   no   no 
## 4219 4220 4227 4234 4235 4237 4242 4243 4248 4251 4254 4257 4263 4270 4271 4279 
##  yes   no   no   no   no  yes   no   no   no   no  yes   no   no   no   no   no 
## 4286 4288 4300 4301 4302 4305 4306 4309 4320 4323 4325 4327 4331 4339 4344 4347 
##  yes   no   no   no   no   no   no   no   no   no   no   no  yes   no   no   no 
## 4362 4363 4364 4365 4367 4375 4383 4385 4389 4390 4391 4392 4396 4399 4407 4409 
##   no   no   no   no  yes   no   no   no   no   no   no   no   no   no   no   no 
## 4411 4421 4427 4428 4432 4440 4442 4445 4450 4451 4458 4460 4461 4462 4467 4469 
##   no   no   no   no   no   no   no   no   no   no   no   no   no   no   no   no 
## 4474 4476 4477 4481 4485 4491 4494 4496 4497 4508 4509 4515 4517 4521 4524 4526 
##   no   no  yes   no   no   no   no   no   no  yes   no   no   no   no   no   no 
## 4529 4530 4531 4532 4535 4548 4551 4562 4565 4568 4570 4572 4579 4582 4586 4588 
##   no   no   no   no   no   no   no   no   no   no   no   no   no   no   no   no 
## 4593 4598 4599 4600 4609 4610 4616 4617 4618 4620 4621 4623 4626 4627 4636 4640 
##  yes  yes   no  yes   no   no   no   no   no   no   no   no   no   no   no   no 
## 4643 4644 4650 4653 4654 4655 4657 4660 4664 4670 4677 4678 4683 4690 4692 4702 
##   no  yes   no   no   no   no   no   no   no   no  yes   no   no   no   no   no 
## 4703 4708 4717 4718 4719 4722 4723 4725 4726 4731 4732 4736 4737 4738 4740 4742 
##   no   no   no   no   no  yes   no   no   no   no   no  yes   no  yes   no   no 
## 4743 4744 4748 4749 4754 4757 4763 4766 4770 4777 4780 4782 4788 4791 4796 4798 
##   no   no   no   no   no   no   no   no   no  yes   no   no   no   no   no   no 
## 4799 4803 4805 4807 4808 4811 4817 4818 4825 4830 4838 4852 4854 4856 4860 4862 
##  yes   no   no   no   no   no   no   no   no   no  yes   no   no   no   no  yes 
## 4863 4866 4869 4870 4877 4878 4879 4882 4887 4888 4890 4893 4895 4896 4897 4900 
##  yes  yes   no   no   no   no   no   no   no   no   no   no   no  yes   no   no 
## 4902 4905 4906 4911 4913 4915 4919 4920 4924 4925 4927 4932 4937 4939 4943 4959 
##   no   no   no   no   no  yes  yes   no   no  yes   no   no   no   no   no   no 
## 4961 4962 4963 4965 4970 4972 4975 4976 4977 4980 4981 4995 
##   no   no   no   no   no   no   no   no   no   no   no   no 
## Levels: no yes</code></pre>
<div class="sourceCode" id="cb634"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">pred1</span><span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span><span class="va">pred</span><span class="op">)</span>
<span class="co">#View(pred1)</span>

<span class="co">#Confusion matrix is a technique for summarizing the performance of a classification algorithm </span>
<span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span><span class="va">testData</span><span class="op">$</span><span class="va">churn</span> ,<span class="va">pred</span><span class="op">)</span><span class="co">#create confusion matrix to see how mnay cus are correctly predicted and incorrectly predicted</span></code></pre></div>
<pre><code>##      pred
##         no  yes
##   no  1267   21
##   yes   65  147</code></pre>
<div class="sourceCode" id="cb636"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">#####</span>
<span class="co">#####RANDOM FOREST MODEL</span>
<span class="co">#####</span>


<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://www.stat.berkeley.edu/~breiman/RandomForests/">randomForest</a></span><span class="op">)</span></code></pre></div>
<pre><code>## randomForest 4.7-1.1</code></pre>
<pre><code>## Type rfNews() to see new features/changes/bug fixes.</code></pre>
<pre><code>## 
## Attaching package: 'randomForest'</code></pre>
<pre><code>## The following object is masked from 'package:rattle':
## 
##     importance</code></pre>
<div class="sourceCode" id="cb641"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">#to build the random forest model </span>
<span class="co">#trainData$churn = as.character(trainData$churn)</span>
<span class="va">random_model</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/randomForest/man/randomForest.html">randomForest</a></span><span class="op">(</span><span class="va">churn</span><span class="op">~</span><span class="va">.</span>,data<span class="op">=</span><span class="va">trainData</span>, importance <span class="op">=</span> <span class="cn">T</span><span class="op">)</span>
<span class="va">random_model</span></code></pre></div>
<pre><code>## 
## Call:
##  randomForest(formula = churn ~ ., data = trainData, importance = T) 
##                Type of random forest: classification
##                      Number of trees: 500
## No. of variables tried at each split: 4
## 
##         OOB estimate of  error rate: 4.2%
## Confusion matrix:
##       no yes class.error
## no  2978  27 0.008985025
## yes  120 375 0.242424242</code></pre>
<div class="sourceCode" id="cb643"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">#predicting the data based on the model developed</span>
<span class="va">ran_pred</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span><span class="op">(</span><span class="va">random_model</span>,<span class="va">testData</span><span class="op">)</span>
<span class="va">ran_pred</span></code></pre></div>
<pre><code>##    2    3    6    7   11   16   19   20   24   36   41   42   45   49   51   53 
##   no   no   no   no  yes  yes   no   no   no   no   no  yes   no  yes   no   no 
##   54   57   59   64   67   70   71   72   73   76   80   88   90   91   93   94 
##   no   no   no   no   no   no   no   no   no   no   no   no   no   no   no   no 
##  105  106  109  110  113  115  119  120  122  123  127  128  129  131  132  134 
##   no   no   no   no  yes   no   no   no   no   no  yes   no   no   no   no   no 
##  147  150  151  154  155  156  160  162  163  171  172  175  179  181  187  194 
##   no   no   no   no   no   no   no   no   no   no   no   no   no   no   no   no 
##  195  196  199  200  201  202  203  205  208  209  216  220  226  228  235  237 
##   no   no   no   no   no   no   no   no   no   no   no   no   no   no   no   no 
##  244  251  253  256  257  258  260  267  268  271  272  276  278  280  281  285 
##   no  yes   no   no   no   no   no   no   no   no   no   no   no   no   no   no 
##  286  290  300  302  306  307  316  319  320  322  330  342  347  350  355  356 
##   no  yes   no  yes   no  yes   no   no  yes   no   no   no   no  yes  yes   no 
##  360  364  366  374  379  380  381  390  391  392  394  396  398  400  403  404 
##   no   no  yes   no  yes   no   no   no   no   no   no   no   no   no   no   no 
##  405  412  416  421  422  426  428  429  433  434  436  441  442  443  449  452 
##   no   no  yes   no   no   no   no   no   no   no   no   no   no   no   no   no 
##  457  458  462  470  478  480  483  487  489  490  491  496  506  508  515  516 
##   no   no   no   no   no   no   no   no   no   no   no   no   no   no   no   no 
##  519  522  524  525  527  529  530  533  535  538  539  546  550  553  563  566 
##   no  yes   no   no   no   no   no   no   no   no   no   no   no  yes   no   no 
##  568  569  575  578  581  583  584  586  590  593  594  597  598  601  608  609 
##   no  yes  yes   no   no   no   no   no   no   no   no   no   no   no   no   no 
##  610  612  617  620  621  625  627  630  632  635  637  640  654  656  659  662 
##   no   no   no  yes   no   no  yes  yes   no   no   no   no   no  yes   no   no 
##  675  676  678  684  688  690  696  697  702  703  708  709  714  719  724  729 
##   no   no   no   no   no   no   no   no   no   no   no   no   no   no   no   no 
##  732  734  735  749  753  757  760  761  762  766  767  771  778  783  785  787 
##   no   no   no   no   no   no   no   no   no   no  yes   no   no   no   no   no 
##  798  801  805  806  807  808  813  817  820  821  822  834  835  838  841  842 
##  yes   no   no   no   no   no   no   no   no   no   no   no   no   no   no   no 
##  852  853  854  855  863  865  868  872  873  877  881  893  894  896  899  901 
##   no   no   no   no   no   no   no  yes   no   no   no   no   no   no   no   no 
##  903  904  917  920  921  927  931  938  940  941  942  945  946  948  949  957 
##   no   no   no   no   no   no   no   no   no   no   no   no   no   no   no   no 
##  964  966  970  974  980  981  987  991  992  994  995 1002 1003 1004 1006 1007 
##   no   no   no   no   no   no   no   no   no   no   no   no   no   no   no   no 
## 1022 1025 1033 1035 1036 1040 1044 1056 1058 1061 1062 1065 1067 1080 1082 1084 
##   no   no   no   no   no   no   no   no   no   no   no   no   no   no   no   no 
## 1089 1092 1093 1096 1097 1098 1099 1104 1109 1113 1114 1117 1119 1124 1128 1129 
##   no   no   no  yes   no   no   no   no   no   no   no   no   no   no   no   no 
## 1130 1131 1132 1133 1136 1137 1142 1143 1145 1147 1148 1150 1151 1157 1159 1164 
##   no   no   no   no   no   no   no  yes   no   no   no   no  yes   no   no   no 
## 1166 1172 1173 1174 1176 1180 1183 1188 1197 1198 1202 1203 1207 1209 1211 1217 
##   no   no   no   no   no   no  yes   no   no   no   no   no   no   no   no   no 
## 1218 1222 1230 1231 1232 1233 1240 1244 1245 1247 1250 1251 1252 1254 1257 1258 
##   no   no   no   no  yes   no   no   no   no   no   no   no   no   no   no   no 
## 1262 1264 1266 1273 1280 1283 1287 1288 1289 1290 1295 1296 1303 1304 1309 1310 
##   no   no   no   no   no   no   no   no   no   no   no   no  yes   no   no   no 
## 1311 1313 1314 1315 1320 1324 1327 1328 1332 1333 1334 1336 1337 1338 1341 1345 
##   no   no   no   no   no   no   no   no   no   no   no   no   no  yes   no  yes 
## 1346 1348 1350 1351 1354 1360 1362 1364 1365 1367 1370 1372 1373 1377 1380 1383 
##  yes   no   no  yes   no   no   no   no  yes   no   no   no   no   no   no   no 
## 1384 1386 1387 1389 1392 1393 1395 1396 1398 1402 1404 1405 1410 1415 1417 1419 
##   no   no   no   no   no  yes   no   no   no   no   no   no   no   no   no   no 
## 1422 1423 1425 1432 1434 1436 1442 1447 1449 1453 1464 1467 1473 1480 1481 1484 
##   no   no   no   no   no  yes   no   no   no   no   no   no  yes   no   no   no 
## 1493 1496 1500 1508 1509 1510 1513 1514 1517 1518 1524 1536 1538 1539 1541 1543 
##   no   no   no   no   no   no   no   no   no   no   no   no  yes  yes   no   no 
## 1546 1549 1551 1552 1553 1563 1565 1567 1570 1571 1572 1573 1586 1593 1594 1596 
##   no   no   no   no   no   no   no   no   no   no   no   no   no   no  yes   no 
## 1597 1598 1608 1613 1614 1616 1617 1622 1623 1625 1626 1628 1631 1633 1640 1642 
##   no   no   no   no   no   no   no   no   no   no   no   no   no   no   no   no 
## 1651 1653 1657 1659 1660 1664 1665 1669 1670 1673 1675 1679 1686 1692 1697 1698 
##   no   no   no   no   no   no   no   no   no   no  yes   no   no  yes   no   no 
## 1699 1700 1701 1707 1708 1715 1717 1718 1719 1729 1733 1737 1744 1745 1750 1755 
##   no   no   no   no  yes   no   no   no   no   no   no  yes   no   no   no  yes 
## 1756 1760 1762 1763 1764 1766 1778 1780 1785 1788 1791 1795 1801 1802 1807 1813 
##   no   no   no   no   no  yes   no   no  yes   no   no  yes   no   no   no  yes 
## 1820 1822 1828 1830 1831 1832 1834 1835 1836 1840 1847 1851 1852 1854 1857 1858 
##   no   no   no   no  yes   no   no   no   no   no   no   no  yes   no   no  yes 
## 1860 1866 1868 1874 1875 1878 1882 1884 1885 1888 1893 1894 1896 1897 1898 1900 
##   no  yes   no   no   no   no  yes   no   no  yes  yes  yes   no   no   no   no 
## 1923 1927 1928 1930 1932 1936 1941 1947 1948 1956 1962 1963 1968 1970 1971 1974 
##   no   no   no   no   no  yes   no   no   no   no   no   no   no   no   no   no 
## 1978 1982 1985 1991 1992 1995 1997 2000 2007 2025 2029 2038 2043 2051 2052 2053 
##  yes   no  yes   no   no   no   no   no   no   no  yes   no   no   no   no   no 
## 2054 2056 2057 2058 2062 2066 2070 2071 2077 2081 2082 2085 2086 2087 2090 2097 
##   no   no   no   no   no   no  yes   no  yes   no   no   no   no   no   no   no 
## 2100 2103 2105 2107 2110 2121 2122 2124 2131 2140 2143 2144 2149 2150 2160 2161 
##  yes   no   no  yes   no   no   no   no   no   no   no   no   no   no   no  yes 
## 2164 2166 2168 2172 2176 2178 2180 2183 2185 2188 2191 2193 2194 2195 2201 2202 
##   no   no   no   no   no   no   no   no   no  yes   no   no  yes   no   no   no 
## 2205 2206 2208 2219 2225 2226 2228 2230 2239 2241 2242 2247 2249 2252 2254 2255 
##   no   no   no  yes   no   no   no   no  yes   no   no   no   no   no   no   no 
## 2256 2258 2262 2266 2269 2275 2276 2277 2279 2283 2288 2289 2291 2292 2293 2294 
##   no   no   no   no   no   no   no   no   no   no   no   no  yes   no   no   no 
## 2297 2298 2302 2303 2308 2311 2312 2315 2317 2318 2321 2330 2336 2339 2342 2346 
##   no   no   no   no   no   no   no   no   no   no   no   no  yes   no   no   no 
## 2350 2353 2354 2357 2361 2374 2380 2382 2388 2392 2398 2400 2402 2409 2410 2417 
##   no   no   no  yes   no   no   no   no   no   no  yes   no  yes   no   no   no 
## 2418 2425 2427 2428 2431 2443 2444 2447 2451 2452 2454 2457 2458 2461 2470 2471 
##   no   no   no   no   no   no   no   no   no  yes   no   no   no   no   no   no 
## 2473 2478 2479 2481 2482 2483 2484 2486 2489 2490 2493 2498 2500 2503 2505 2506 
##   no   no   no   no   no   no   no   no   no   no   no   no   no   no   no   no 
## 2511 2512 2517 2519 2520 2524 2525 2532 2534 2535 2536 2537 2547 2552 2559 2560 
##   no   no   no   no   no   no   no   no   no   no   no  yes   no   no   no   no 
## 2567 2568 2569 2577 2581 2584 2590 2593 2594 2596 2598 2600 2604 2608 2611 2613 
##   no   no   no   no   no   no   no   no   no  yes   no  yes   no   no   no   no 
## 2619 2620 2627 2635 2637 2638 2640 2644 2650 2651 2652 2653 2657 2660 2664 2665 
##   no  yes   no   no   no   no   no   no   no   no   no   no   no   no   no  yes 
## 2669 2670 2671 2673 2676 2678 2681 2682 2683 2697 2699 2700 2701 2703 2704 2707 
##   no   no   no   no   no  yes   no   no   no  yes   no   no  yes   no   no   no 
## 2711 2712 2713 2720 2724 2727 2733 2734 2739 2740 2751 2761 2762 2767 2770 2772 
##  yes   no   no   no   no   no  yes   no   no   no   no  yes   no   no   no   no 
## 2775 2781 2782 2786 2788 2792 2793 2795 2807 2809 2810 2819 2821 2823 2826 2827 
##  yes   no   no   no   no   no   no   no   no   no   no   no  yes   no   no   no 
## 2830 2834 2842 2843 2850 2854 2855 2859 2861 2874 2876 2877 2879 2884 2889 2890 
##   no   no   no   no   no   no   no   no   no   no   no   no   no   no   no  yes 
## 2892 2893 2894 2898 2899 2900 2901 2903 2911 2915 2922 2926 2929 2931 2933 2934 
##   no   no   no   no   no   no   no   no   no   no   no   no   no   no   no   no 
## 2936 2939 2940 2941 2953 2956 2958 2959 2969 2974 2978 2980 2981 2983 2985 2988 
##   no   no   no   no   no   no   no  yes   no   no   no  yes   no   no   no  yes 
## 2993 2995 2996 2999 3005 3006 3007 3016 3017 3024 3031 3032 3033 3034 3036 3037 
##   no  yes   no   no   no   no   no   no   no  yes   no   no   no   no  yes   no 
## 3038 3039 3042 3045 3046 3049 3055 3056 3059 3066 3067 3072 3077 3080 3082 3083 
##   no   no   no   no  yes   no   no   no   no   no   no   no   no  yes   no   no 
## 3086 3091 3092 3094 3097 3099 3101 3103 3106 3108 3111 3118 3126 3130 3131 3138 
##   no   no   no  yes   no   no   no   no   no   no   no   no  yes   no   no   no 
## 3139 3142 3143 3148 3149 3150 3157 3159 3164 3173 3174 3177 3178 3179 3182 3184 
##   no   no   no   no  yes   no   no   no   no   no   no   no   no   no   no   no 
## 3188 3189 3193 3200 3205 3206 3210 3214 3215 3225 3226 3227 3228 3229 3230 3232 
##   no   no   no   no   no  yes  yes   no   no  yes   no   no   no   no   no   no 
## 3233 3240 3244 3249 3251 3263 3274 3275 3277 3279 3282 3284 3285 3287 3290 3296 
##   no   no  yes   no   no   no   no   no   no   no   no   no   no   no   no   no 
## 3298 3299 3307 3308 3309 3310 3312 3319 3320 3324 3328 3330 3338 3339 3340 3341 
##   no   no   no   no   no   no   no   no   no  yes   no   no   no   no   no   no 
## 3349 3352 3353 3354 3355 3364 3368 3371 3377 3381 3385 3403 3404 3405 3406 3413 
##   no   no   no   no   no   no   no   no  yes   no   no   no   no   no   no   no 
## 3415 3418 3419 3423 3431 3434 3435 3440 3446 3449 3450 3455 3456 3458 3461 3463 
##   no   no   no   no   no   no   no   no   no   no   no   no   no  yes   no   no 
## 3466 3476 3484 3506 3508 3514 3522 3530 3541 3546 3549 3550 3551 3565 3567 3568 
##   no   no   no   no   no   no   no   no  yes   no  yes  yes   no   no   no   no 
## 3569 3570 3573 3574 3582 3583 3585 3586 3588 3590 3598 3602 3617 3618 3620 3621 
##   no   no   no   no   no   no   no  yes  yes   no   no   no  yes  yes   no   no 
## 3628 3635 3636 3640 3641 3644 3645 3652 3653 3654 3662 3663 3664 3671 3672 3673 
##   no   no   no   no   no   no   no   no   no   no   no   no   no   no   no   no 
## 3675 3682 3684 3686 3689 3691 3692 3695 3697 3698 3702 3705 3709 3714 3715 3718 
##   no  yes   no   no  yes   no   no   no   no   no   no   no   no   no   no  yes 
## 3719 3720 3721 3724 3741 3743 3744 3749 3750 3752 3757 3759 3765 3768 3770 3774 
##   no   no   no   no   no   no   no   no   no   no   no   no   no   no   no   no 
## 3777 3781 3782 3783 3784 3787 3789 3793 3795 3796 3798 3805 3810 3812 3814 3817 
##   no   no   no   no   no   no   no   no   no   no   no   no   no   no   no   no 
## 3818 3820 3822 3825 3827 3837 3838 3842 3846 3847 3848 3849 3853 3854 3860 3863 
##   no   no   no   no   no   no   no   no   no   no  yes   no   no   no   no   no 
## 3868 3869 3871 3874 3875 3877 3880 3886 3890 3900 3902 3904 3909 3911 3913 3914 
##   no   no   no  yes   no   no   no   no   no   no  yes   no   no   no   no   no 
## 3916 3921 3925 3927 3931 3933 3940 3941 3942 3944 3955 3956 3958 3959 3963 3967 
##   no   no   no   no   no   no   no   no   no   no   no   no   no   no   no  yes 
## 3971 3976 3979 3981 3985 3989 3993 3995 3998 3999 4002 4003 4005 4011 4015 4016 
##   no   no  yes   no   no   no   no   no   no   no   no  yes   no   no   no   no 
## 4017 4021 4028 4031 4034 4040 4047 4050 4051 4054 4057 4062 4064 4068 4071 4072 
##   no   no   no  yes   no   no   no   no   no  yes   no   no   no   no   no   no 
## 4073 4077 4082 4083 4092 4093 4098 4102 4103 4107 4108 4112 4113 4114 4116 4119 
##   no   no   no   no   no   no   no   no   no   no   no   no   no   no   no   no 
## 4120 4125 4126 4127 4131 4139 4146 4147 4154 4158 4160 4161 4162 4166 4169 4173 
##   no   no   no   no  yes   no   no   no  yes   no   no   no   no  yes   no   no 
## 4175 4177 4181 4183 4184 4186 4187 4188 4192 4193 4194 4195 4201 4204 4216 4217 
##   no   no   no   no   no   no   no   no   no   no   no   no   no   no   no   no 
## 4219 4220 4227 4234 4235 4237 4242 4243 4248 4251 4254 4257 4263 4270 4271 4279 
##   no   no   no   no   no  yes   no   no   no   no  yes   no   no   no   no   no 
## 4286 4288 4300 4301 4302 4305 4306 4309 4320 4323 4325 4327 4331 4339 4344 4347 
##  yes   no   no   no   no   no   no   no   no   no   no   no  yes   no   no   no 
## 4362 4363 4364 4365 4367 4375 4383 4385 4389 4390 4391 4392 4396 4399 4407 4409 
##   no   no   no   no  yes   no   no   no   no   no   no   no   no   no  yes   no 
## 4411 4421 4427 4428 4432 4440 4442 4445 4450 4451 4458 4460 4461 4462 4467 4469 
##   no   no   no   no   no   no   no   no   no   no   no   no   no   no   no   no 
## 4474 4476 4477 4481 4485 4491 4494 4496 4497 4508 4509 4515 4517 4521 4524 4526 
##   no   no  yes   no   no   no   no   no   no  yes   no   no   no   no   no   no 
## 4529 4530 4531 4532 4535 4548 4551 4562 4565 4568 4570 4572 4579 4582 4586 4588 
##   no   no   no   no   no   no   no   no   no   no   no   no   no   no   no   no 
## 4593 4598 4599 4600 4609 4610 4616 4617 4618 4620 4621 4623 4626 4627 4636 4640 
##  yes  yes   no  yes   no   no   no   no   no   no   no   no   no   no   no   no 
## 4643 4644 4650 4653 4654 4655 4657 4660 4664 4670 4677 4678 4683 4690 4692 4702 
##   no  yes   no   no   no   no   no   no   no   no  yes   no   no   no   no   no 
## 4703 4708 4717 4718 4719 4722 4723 4725 4726 4731 4732 4736 4737 4738 4740 4742 
##   no   no   no   no   no  yes   no   no   no   no   no  yes   no  yes   no   no 
## 4743 4744 4748 4749 4754 4757 4763 4766 4770 4777 4780 4782 4788 4791 4796 4798 
##   no   no   no   no   no   no   no   no   no  yes   no   no   no   no   no   no 
## 4799 4803 4805 4807 4808 4811 4817 4818 4825 4830 4838 4852 4854 4856 4860 4862 
##  yes   no   no   no   no   no   no   no   no   no  yes   no   no   no   no  yes 
## 4863 4866 4869 4870 4877 4878 4879 4882 4887 4888 4890 4893 4895 4896 4897 4900 
##  yes   no   no   no   no   no   no   no   no   no   no   no   no  yes   no   no 
## 4902 4905 4906 4911 4913 4915 4919 4920 4924 4925 4927 4932 4937 4939 4943 4959 
##   no   no   no   no   no  yes  yes  yes   no  yes   no   no   no   no   no   no 
## 4961 4962 4963 4965 4970 4972 4975 4976 4977 4980 4981 4995 
##   no   no   no   no   no   no   no   no   no   no   no   no 
## Levels: no yes</code></pre>
<div class="sourceCode" id="cb645"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">ran_pred1</span> <span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span><span class="va">ran_pred</span><span class="op">)</span>

<span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span><span class="va">testData</span><span class="op">$</span><span class="va">churn</span> ,<span class="va">ran_pred</span><span class="op">)</span> <span class="co"># confusion matrix</span></code></pre></div>
<pre><code>##      ran_pred
##         no  yes
##   no  1281    7
##   yes   60  152</code></pre>
<div class="sourceCode" id="cb647"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">#accuracy rate </span>
<span class="op">(</span><span class="fl">1276</span><span class="op">+</span> <span class="fl">173</span><span class="op">)</span><span class="op">/</span><span class="op">(</span><span class="fl">1276</span><span class="op">+</span><span class="fl">12</span><span class="op">+</span><span class="fl">39</span><span class="op">+</span><span class="fl">173</span><span class="op">)</span> <span class="co"># 97 % of accuracy : higher than decision tree , where accuracy rate is 95 % </span></code></pre></div>
<pre><code>## [1] 0.966</code></pre>
<div class="sourceCode" id="cb649"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">#most commonly mean decrease gini is considered</span>
<span class="fu"><a href="https://rdrr.io/pkg/randomForest/man/importance.html">importance</a></span><span class="op">(</span><span class="va">random_model</span><span class="op">)</span></code></pre></div>
<pre><code>##                                       no         yes MeanDecreaseAccuracy
## international_plan            71.0245852  88.5909606           92.1024166
## voice_mail_plan               19.4252161  23.3559214           24.0520611
## number_vmail_messages         17.1853910  21.6990129           21.5570005
## total_day_minutes             30.6348120  35.7502311           40.2920546
## total_day_calls               -1.1882307   0.6417423           -0.7944357
## total_day_charge              31.4130417  34.8614675           41.3702781
## total_eve_minutes             21.3969480  24.4428743           25.5711900
## total_eve_calls               -2.7481483  -3.5381785           -4.2150019
## total_eve_charge              21.6778229  23.6392559           25.3989519
## total_night_minutes           19.0751605   4.5281187           20.2127669
## total_night_calls             -0.2315282  -0.9491223           -0.5885848
## total_night_charge            18.9749955   6.7916153           20.1591438
## total_intl_minutes            23.0964208  19.7009145           27.8699894
## total_intl_calls              35.6108036  48.6332947           49.8661556
## total_intl_charge             22.2922415  19.3197649           27.3786241
## number_customer_service_calls 74.5565765 106.3763370          104.5643190
##                               MeanDecreaseGini
## international_plan                    73.44349
## voice_mail_plan                       19.44855
## number_vmail_messages                 22.76746
## total_day_minutes                    120.10909
## total_day_calls                       24.98078
## total_day_charge                     121.97827
## total_eve_minutes                     59.84238
## total_eve_calls                       23.19389
## total_eve_charge                      60.20540
## total_night_minutes                   34.08249
## total_night_calls                     23.99879
## total_night_charge                    35.25618
## total_intl_minutes                    39.48899
## total_intl_calls                      48.92762
## total_intl_charge                     39.60016
## number_customer_service_calls        101.61579</code></pre>
<div class="sourceCode" id="cb651"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Variables that result in nodes with higher purity have a higher decrease in Gini coefficient.</span>
<span class="fu"><a href="https://rdrr.io/pkg/randomForest/man/varImpPlot.html">varImpPlot</a></span><span class="op">(</span><span class="va">random_model</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="07-decisiontree_files/figure-html/project-2.png" width="672"></div>
<div class="sourceCode" id="cb652"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">#total day charges have higher decrease in gini index so its more significant than other</span></code></pre></div>

</div>
</div>
  <div class="chapter-nav">
<div class="prev"><a href="logistic%E5%9B%9E%E5%BD%92.html"><span class="header-section-number">7</span> Logistic回归</a></div>
<div class="next"><a href="github%E4%BD%BF%E7%94%A8.html"><span class="header-section-number">9</span> github使用</a></div>
</div></main><div class="col-md-3 col-lg-2 d-none d-md-block sidebar sidebar-chapter">
    <nav id="toc" data-toggle="toc" aria-label="On this page"><h2>On this page</h2>
      <ul class="nav navbar-nav">
<li><a class="nav-link" href="#%E5%86%B3%E7%AD%96%E6%A0%91%E5%8F%8A%E5%85%B6%E7%BB%84%E5%90%88%E6%96%B9%E6%B3%95"><span class="header-section-number">8</span> 决策树及其组合方法</a></li>
<li><a class="nav-link" href="#%E5%86%B3%E7%AD%96%E6%A0%91"><span class="header-section-number">8.1</span> 决策树</a></li>
<li><a class="nav-link" href="#%E5%AE%9E%E4%BE%8B-1"><span class="header-section-number">8.2</span> 实例</a></li>
</ul>

      <div class="book-extra">
        <ul class="list-unstyled">
          
        </ul>
</div>
    </nav>
</div>

</div>
</div> <!-- .container -->

<footer class="bg-primary text-light mt-5"><div class="container"><div class="row">

  <div class="col-12 col-md-6 mt-3">
    <p>"<strong>数据科学导论（Introductory of Data Science）</strong>" was written by 潘蓄林. It was last built on 2022-06-01.</p>
  </div>

  <div class="col-12 col-md-6 mt-3">
    <p>This book was built by the <a class="text-light" href="https://bookdown.org">bookdown</a> R package.</p>
  </div>

</div></div>
</footer><!-- dynamically load mathjax for compatibility with self-contained --><script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script><script type="text/x-mathjax-config">const popovers = document.querySelectorAll('a.footnote-ref[data-toggle="popover"]');
for (let popover of popovers) {
  const div = document.createElement('div');
  div.setAttribute('style', 'position: absolute; top: 0, left:0; width:0, height:0, overflow: hidden; visibility: hidden;');
  div.innerHTML = popover.getAttribute('data-content');

  var has_math = div.querySelector("span.math");
  if (has_math) {
    document.body.appendChild(div);
    MathJax.Hub.Queue(["Typeset", MathJax.Hub, div]);
    MathJax.Hub.Queue(function() {
      popover.setAttribute('data-content', div.innerHTML);
      document.body.removeChild(div);
    })
  }
}
</script>
</body>
</html>
