<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Chapter 8 决策树及其组合方法 | 数据科学导论（Introductory of Data Science）</title>
<meta name="author" content="潘蓄林">
<meta name="description" content="Decision Tree: A decision tree is a decision support tool that uses a tree-like graph or model of decisions and their possible consequences, including chance event outcomes, resource costs, and...">
<meta name="generator" content="bookdown 0.25 with bs4_book()">
<meta property="og:title" content="Chapter 8 决策树及其组合方法 | 数据科学导论（Introductory of Data Science）">
<meta property="og:type" content="book">
<meta property="og:description" content="Decision Tree: A decision tree is a decision support tool that uses a tree-like graph or model of decisions and their possible consequences, including chance event outcomes, resource costs, and...">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Chapter 8 决策树及其组合方法 | 数据科学导论（Introductory of Data Science）">
<meta name="twitter:description" content="Decision Tree: A decision tree is a decision support tool that uses a tree-like graph or model of decisions and their possible consequences, including chance event outcomes, resource costs, and...">
<!-- JS --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://kit.fontawesome.com/6ecbd6c532.js" crossorigin="anonymous"></script><script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="libs/bootstrap-4.6.0/bootstrap.min.css" rel="stylesheet">
<script src="libs/bootstrap-4.6.0/bootstrap.bundle.min.js"></script><script src="libs/bs3compat-0.3.1/transition.js"></script><script src="libs/bs3compat-0.3.1/tabs.js"></script><script src="libs/bs3compat-0.3.1/bs3compat.js"></script><link href="libs/bs4_book-1.0.0/bs4_book.css" rel="stylesheet">
<script src="libs/bs4_book-1.0.0/bs4_book.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- CSS --><style type="text/css">
    
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  </style>
</head>
<body data-spy="scroll" data-target="#toc">

<div class="container-fluid">
<div class="row">
  <header class="col-sm-12 col-lg-3 sidebar sidebar-book"><a class="sr-only sr-only-focusable" href="#content">Skip to main content</a>

    <div class="d-flex align-items-start justify-content-between">
      <h1>
        <a href="index.html" title="">数据科学导论（Introductory of Data Science）</a>
      </h1>
      <button class="btn btn-outline-primary d-lg-none ml-2 mt-1" type="button" data-toggle="collapse" data-target="#main-nav" aria-expanded="true" aria-controls="main-nav"><i class="fas fa-bars"></i><span class="sr-only">Show table of contents</span></button>
    </div>

    <div id="main-nav" class="collapse-lg">
      <form role="search">
        <input id="search" class="form-control" type="search" placeholder="Search" aria-label="Search">
</form>

      <nav aria-label="Table of contents"><h2>Table of contents</h2>
        <ul class="book-toc list-unstyled">
<li><a class="" href="index.html"><span class="header-section-number">1</span> 前言（Prerequisites）</a></li>
<li><a class="" href="r%E5%8F%8Apython%E8%AF%AD%E8%A8%80%E7%AE%80%E4%BB%8B.html"><span class="header-section-number">2</span> R及Python语言简介</a></li>
<li><a class="" href="%E6%95%B0%E6%8D%AE%E6%8F%8F%E8%BF%B0.html"><span class="header-section-number">3</span> 数据描述</a></li>
<li><a class="" href="%E6%95%B0%E6%8D%AE%E6%95%B4%E7%90%86%E5%92%8C%E6%B8%85%E7%90%86.html"><span class="header-section-number">4</span> 数据整理和清理</a></li>
<li><a class="" href="%E6%9C%89%E7%9B%91%E7%9D%A3%E5%AD%A6%E4%B9%A0%E6%A6%82%E8%AE%BA.html"><span class="header-section-number">5</span> 有监督学习概论</a></li>
<li><a class="" href="%E6%9C%80%E5%B0%8F%E4%BA%8C%E4%B9%98%E7%BA%BF%E6%80%A7%E5%9B%9E%E5%BD%92%E6%B3%95.html"><span class="header-section-number">6</span> 最小二乘线性回归法</a></li>
<li><a class="" href="logistic%E5%9B%9E%E5%BD%92.html"><span class="header-section-number">7</span> Logistic回归</a></li>
<li><a class="active" href="%E5%86%B3%E7%AD%96%E6%A0%91%E5%8F%8A%E5%85%B6%E7%BB%84%E5%90%88%E6%96%B9%E6%B3%95.html"><span class="header-section-number">8</span> 决策树及其组合方法</a></li>
<li><a class="" href="%E6%94%AF%E6%8C%81%E5%90%91%E9%87%8F%E6%9C%BA%E5%92%8C%E7%A5%9E%E7%BB%8F%E7%BD%91%E7%BB%9C.html"><span class="header-section-number">9</span> 支持向量机和神经网络</a></li>
<li><a class="" href="github%E4%BD%BF%E7%94%A8.html"><span class="header-section-number">10</span> github使用</a></li>
<li><a class="" href="references.html">References</a></li>
<li><a class="" href="references-1.html">References</a></li>
</ul>

        <div class="book-extra">
          
        </div>
      </nav>
</div>
  </header><main class="col-sm-12 col-md-9 col-lg-7" id="content"><div id="决策树及其组合方法" class="section level1" number="8">
<h1>
<span class="header-section-number">8</span> 决策树及其组合方法<a class="anchor" aria-label="anchor" href="#%E5%86%B3%E7%AD%96%E6%A0%91%E5%8F%8A%E5%85%B6%E7%BB%84%E5%90%88%E6%96%B9%E6%B3%95"><i class="fas fa-link"></i></a>
</h1>
<ul>
<li><p>Decision Tree: A decision tree is a decision support tool that uses a tree-like graph or model of decisions and their possible consequences, including chance event outcomes, resource costs, and utility.</p></li>
<li><p>Decision trees are produced by algorithms that identify various ways of splitting a data set into branch-like segments. These segments form an inverted decision tree that originates with a root node at the top of the tree.</p></li>
</ul>
<div id="决策树" class="section level2" number="8.1">
<h2>
<span class="header-section-number">8.1</span> 决策树<a class="anchor" aria-label="anchor" href="#%E5%86%B3%E7%AD%96%E6%A0%91"><i class="fas fa-link"></i></a>
</h2>
</div>
<div id="实例-1" class="section level2" number="8.2">
<h2>
<span class="header-section-number">8.2</span> 实例<a class="anchor" aria-label="anchor" href="#%E5%AE%9E%E4%BE%8B-1"><i class="fas fa-link"></i></a>
</h2>
<div class="sourceCode" id="cb613"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">#####</span>
<span class="co"># importing churn data set from .csv file</span>
<span class="va">data1</span> <span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/utils/read.table.html">read.csv</a></span><span class="op">(</span><span class="st">"./data/chun_data.csv"</span>,header<span class="op">=</span> <span class="cn">TRUE</span>,sep<span class="op">=</span><span class="st">","</span><span class="op">)</span>

<span class="co">#as the first three columns of the data arent important for the prediction we drop those columns from the data frame </span>
<span class="co"># drop the variables from the data set</span>
<span class="va">data1</span><span class="op">&lt;-</span><span class="va">data1</span><span class="op">[</span><span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span>,<span class="fl">3</span><span class="op">)</span><span class="op">]</span>

<span class="co">#data exploration</span>

<span class="co">#gives the dimensions of the data set</span>
<span class="fu"><a href="https://rdrr.io/r/base/dim.html">dim</a></span><span class="op">(</span><span class="va">data1</span><span class="op">)</span></code></pre></div>
<pre><code>## [1] 5000   17</code></pre>
<div class="sourceCode" id="cb615"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">#gives the names of the variables in the data set</span>
<span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">data1</span><span class="op">)</span></code></pre></div>
<pre><code>##  [1] "international_plan"            "voice_mail_plan"              
##  [3] "number_vmail_messages"         "total_day_minutes"            
##  [5] "total_day_calls"               "total_day_charge"             
##  [7] "total_eve_minutes"             "total_eve_calls"              
##  [9] "total_eve_charge"              "total_night_minutes"          
## [11] "total_night_calls"             "total_night_charge"           
## [13] "total_intl_minutes"            "total_intl_calls"             
## [15] "total_intl_charge"             "number_customer_service_calls"
## [17] "churn"</code></pre>
<div class="sourceCode" id="cb617"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">#displays top 10 observations of the data set</span>
<span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">data1</span><span class="op">)</span></code></pre></div>
<pre><code>##   international_plan voice_mail_plan number_vmail_messages total_day_minutes
## 1                 no             yes                    25             265.1
## 2                 no             yes                    26             161.6
## 3                 no              no                     0             243.4
## 4                yes              no                     0             299.4
## 5                yes              no                     0             166.7
## 6                yes              no                     0             223.4
##   total_day_calls total_day_charge total_eve_minutes total_eve_calls
## 1             110            45.07             197.4              99
## 2             123            27.47             195.5             103
## 3             114            41.38             121.2             110
## 4              71            50.90              61.9              88
## 5             113            28.34             148.3             122
## 6              98            37.98             220.6             101
##   total_eve_charge total_night_minutes total_night_calls total_night_charge
## 1            16.78               244.7                91              11.01
## 2            16.62               254.4               103              11.45
## 3            10.30               162.6               104               7.32
## 4             5.26               196.9                89               8.86
## 5            12.61               186.9               121               8.41
## 6            18.75               203.9               118               9.18
##   total_intl_minutes total_intl_calls total_intl_charge
## 1               10.0                3              2.70
## 2               13.7                3              3.70
## 3               12.2                5              3.29
## 4                6.6                7              1.78
## 5               10.1                3              2.73
## 6                6.3                6              1.70
##   number_customer_service_calls churn
## 1                             1    no
## 2                             1    no
## 3                             0    no
## 4                             2    no
## 5                             3    no
## 6                             0    no</code></pre>
<div class="sourceCode" id="cb619"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">#displays bottom top 10 observations of the data set</span>
<span class="fu"><a href="https://rdrr.io/r/utils/head.html">tail</a></span><span class="op">(</span><span class="va">data1</span><span class="op">)</span></code></pre></div>
<pre><code>##      international_plan voice_mail_plan number_vmail_messages total_day_minutes
## 4995                 no              no                     0             170.7
## 4996                 no             yes                    40             235.7
## 4997                 no              no                     0             184.2
## 4998                 no              no                     0             140.6
## 4999                 no              no                     0             188.8
## 5000                 no             yes                    34             129.4
##      total_day_calls total_day_charge total_eve_minutes total_eve_calls
## 4995             101            29.02             193.1             126
## 4996             127            40.07             223.0             126
## 4997              90            31.31             256.8              73
## 4998              89            23.90             172.8             128
## 4999              67            32.10             171.7              92
## 5000             102            22.00             267.1             104
##      total_eve_charge total_night_minutes total_night_calls total_night_charge
## 4995            16.41               129.1               104               5.81
## 4996            18.96               297.5               116              13.39
## 4997            21.83               213.6               113               9.61
## 4998            14.69               212.4                97               9.56
## 4999            14.59               224.4                89              10.10
## 5000            22.70               154.8               100               6.97
##      total_intl_minutes total_intl_calls total_intl_charge
## 4995                6.9                7              1.86
## 4996                9.9                5              2.67
## 4997               14.7                2              3.97
## 4998               13.6                4              3.67
## 4999                8.5                6              2.30
## 5000                9.3               16              2.51
##      number_customer_service_calls churn
## 4995                             1    no
## 4996                             2    no
## 4997                             3   yes
## 4998                             1    no
## 4999                             0    no
## 5000                             0    no</code></pre>
<div class="sourceCode" id="cb621"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">#displays structure of the variables in the data set</span>
<span class="fu"><a href="https://rdrr.io/r/utils/str.html">str</a></span><span class="op">(</span><span class="va">data1</span><span class="op">)</span></code></pre></div>
<pre><code>## 'data.frame':    5000 obs. of  17 variables:
##  $ international_plan           : chr  "no" "no" "no" "yes" ...
##  $ voice_mail_plan              : chr  "yes" "yes" "no" "no" ...
##  $ number_vmail_messages        : int  25 26 0 0 0 0 24 0 0 37 ...
##  $ total_day_minutes            : num  265 162 243 299 167 ...
##  $ total_day_calls              : int  110 123 114 71 113 98 88 79 97 84 ...
##  $ total_day_charge             : num  45.1 27.5 41.4 50.9 28.3 ...
##  $ total_eve_minutes            : num  197.4 195.5 121.2 61.9 148.3 ...
##  $ total_eve_calls              : int  99 103 110 88 122 101 108 94 80 111 ...
##  $ total_eve_charge             : num  16.78 16.62 10.3 5.26 12.61 ...
##  $ total_night_minutes          : num  245 254 163 197 187 ...
##  $ total_night_calls            : int  91 103 104 89 121 118 118 96 90 97 ...
##  $ total_night_charge           : num  11.01 11.45 7.32 8.86 8.41 ...
##  $ total_intl_minutes           : num  10 13.7 12.2 6.6 10.1 6.3 7.5 7.1 8.7 11.2 ...
##  $ total_intl_calls             : int  3 3 5 7 3 6 7 6 4 5 ...
##  $ total_intl_charge            : num  2.7 3.7 3.29 1.78 2.73 1.7 2.03 1.92 2.35 3.02 ...
##  $ number_customer_service_calls: int  1 1 0 2 3 0 3 0 1 0 ...
##  $ churn                        : chr  "no" "no" "no" "no" ...</code></pre>
<div class="sourceCode" id="cb623"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">#gives the summary of the variables of the data set </span>
<span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">data1</span><span class="op">)</span></code></pre></div>
<pre><code>##  international_plan voice_mail_plan    number_vmail_messages total_day_minutes
##  Length:5000        Length:5000        Min.   : 0.000        Min.   :  0.0    
##  Class :character   Class :character   1st Qu.: 0.000        1st Qu.:143.7    
##  Mode  :character   Mode  :character   Median : 0.000        Median :180.1    
##                                        Mean   : 7.755        Mean   :180.3    
##                                        3rd Qu.:17.000        3rd Qu.:216.2    
##                                        Max.   :52.000        Max.   :351.5    
##  total_day_calls total_day_charge total_eve_minutes total_eve_calls
##  Min.   :  0     Min.   : 0.00    Min.   :  0.0     Min.   :  0.0  
##  1st Qu.: 87     1st Qu.:24.43    1st Qu.:166.4     1st Qu.: 87.0  
##  Median :100     Median :30.62    Median :201.0     Median :100.0  
##  Mean   :100     Mean   :30.65    Mean   :200.6     Mean   :100.2  
##  3rd Qu.:113     3rd Qu.:36.75    3rd Qu.:234.1     3rd Qu.:114.0  
##  Max.   :165     Max.   :59.76    Max.   :363.7     Max.   :170.0  
##  total_eve_charge total_night_minutes total_night_calls total_night_charge
##  Min.   : 0.00    Min.   :  0.0       Min.   :  0.00    Min.   : 0.000    
##  1st Qu.:14.14    1st Qu.:166.9       1st Qu.: 87.00    1st Qu.: 7.510    
##  Median :17.09    Median :200.4       Median :100.00    Median : 9.020    
##  Mean   :17.05    Mean   :200.4       Mean   : 99.92    Mean   : 9.018    
##  3rd Qu.:19.90    3rd Qu.:234.7       3rd Qu.:113.00    3rd Qu.:10.560    
##  Max.   :30.91    Max.   :395.0       Max.   :175.00    Max.   :17.770    
##  total_intl_minutes total_intl_calls total_intl_charge
##  Min.   : 0.00      Min.   : 0.000   Min.   :0.000    
##  1st Qu.: 8.50      1st Qu.: 3.000   1st Qu.:2.300    
##  Median :10.30      Median : 4.000   Median :2.780    
##  Mean   :10.26      Mean   : 4.435   Mean   :2.771    
##  3rd Qu.:12.00      3rd Qu.: 6.000   3rd Qu.:3.240    
##  Max.   :20.00      Max.   :20.000   Max.   :5.400    
##  number_customer_service_calls    churn          
##  Min.   :0.00                  Length:5000       
##  1st Qu.:1.00                  Class :character  
##  Median :1.00                  Mode  :character  
##  Mean   :1.57                                    
##  3rd Qu.:2.00                                    
##  Max.   :9.00</code></pre>
<div class="sourceCode" id="cb625"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">#library for the sample.split function</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">caTools</span><span class="op">)</span>

<span class="co">#splitting the data into training and testing data </span>
<span class="co"># sample the input data with 70% for training and 30% for testing</span>
<span class="va">data1</span><span class="op">$</span><span class="va">churn</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="va">data1</span><span class="op">$</span><span class="va">churn</span><span class="op">)</span>
<span class="va">sample</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/caTools/man/sample.split.html">sample.split</a></span><span class="op">(</span><span class="va">data1</span><span class="op">$</span><span class="va">churn</span>,SplitRatio<span class="op">=</span><span class="fl">0.70</span><span class="op">)</span>

<span class="va">trainData</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/subset.data.table.html">subset</a></span><span class="op">(</span><span class="va">data1</span>,<span class="va">sample</span><span class="op">==</span><span class="cn">TRUE</span><span class="op">)</span>

<span class="va">testData</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/subset.data.table.html">subset</a></span><span class="op">(</span><span class="va">data1</span>,<span class="va">sample</span><span class="op">==</span><span class="cn">FALSE</span><span class="op">)</span>

<span class="co">#rpart --- recursive partitioning decision tree</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/bethatkinson/rpart">rpart</a></span><span class="op">)</span>

<span class="co">#TO BUILD DECISON TREE BY USING RPART PACKAGE(recursive partitioning decision tree)</span>
<span class="va">churn_model</span><span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/rpart/man/rpart.html">rpart</a></span><span class="op">(</span><span class="va">churn</span> <span class="op">~</span> <span class="va">.</span>,data<span class="op">=</span><span class="va">trainData</span><span class="op">)</span>
<span class="va">churn_model</span></code></pre></div>
<pre><code>## n= 3500 
## 
## node), split, n, loss, yval, (yprob)
##       * denotes terminal node
## 
##   1) root 3500 495 no (0.85857143 0.14142857)  
##     2) total_day_minutes&lt; 263.55 3276 362 no (0.88949939 0.11050061)  
##       4) number_customer_service_calls&lt; 3.5 3009 234 no (0.92223330 0.07776670)  
##         8) international_plan=no 2743 134 no (0.95114838 0.04885162)  
##          16) total_day_minutes&lt; 221.85 2309  62 no (0.97314855 0.02685145) *
##          17) total_day_minutes&gt;=221.85 434  72 no (0.83410138 0.16589862)  
##            34) total_eve_minutes&lt; 242.7 353  25 no (0.92917847 0.07082153) *
##            35) total_eve_minutes&gt;=242.7 81  34 yes (0.41975309 0.58024691)  
##              70) voice_mail_plan=yes 14   0 no (1.00000000 0.00000000) *
##              71) voice_mail_plan=no 67  20 yes (0.29850746 0.70149254)  
##               142) total_night_minutes&lt; 172.5 17   4 no (0.76470588 0.23529412) *
##               143) total_night_minutes&gt;=172.5 50   7 yes (0.14000000 0.86000000) *
##         9) international_plan=yes 266 100 no (0.62406015 0.37593985)  
##          18) total_intl_calls&gt;=2.5 214  48 no (0.77570093 0.22429907)  
##            36) total_intl_minutes&lt; 13.1 170   4 no (0.97647059 0.02352941) *
##            37) total_intl_minutes&gt;=13.1 44   0 yes (0.00000000 1.00000000) *
##          19) total_intl_calls&lt; 2.5 52   0 yes (0.00000000 1.00000000) *
##       5) number_customer_service_calls&gt;=3.5 267 128 no (0.52059925 0.47940075)  
##        10) total_day_minutes&gt;=162.7 157  32 no (0.79617834 0.20382166)  
##          20) total_eve_minutes&gt;=135.1 143  22 no (0.84615385 0.15384615) *
##          21) total_eve_minutes&lt; 135.1 14   4 yes (0.28571429 0.71428571) *
##        11) total_day_minutes&lt; 162.7 110  14 yes (0.12727273 0.87272727) *
##     3) total_day_minutes&gt;=263.55 224  91 yes (0.40625000 0.59375000)  
##       6) voice_mail_plan=yes 50   5 no (0.90000000 0.10000000) *
##       7) voice_mail_plan=no 174  46 yes (0.26436782 0.73563218)  
##        14) total_eve_minutes&lt; 185.15 69  29 no (0.57971014 0.42028986)  
##          28) total_day_minutes&lt; 289.2 48  12 no (0.75000000 0.25000000) *
##          29) total_day_minutes&gt;=289.2 21   4 yes (0.19047619 0.80952381) *
##        15) total_eve_minutes&gt;=185.15 105   6 yes (0.05714286 0.94285714) *</code></pre>
<div class="sourceCode" id="cb627"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">#to display it in diagram</span>

<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://rattle.togaware.com/">rattle</a></span><span class="op">)</span></code></pre></div>
<pre><code>## Loading required package: tibble</code></pre>
<pre><code>## Loading required package: bitops</code></pre>
<pre><code>## Rattle: A free graphical interface for data science with R.
## Version 5.5.1 Copyright (c) 2006-2021 Togaware Pty Ltd.
## Type 'rattle()' to shake, rattle, and roll your data.</code></pre>
<div class="sourceCode" id="cb631"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="http://www.milbo.org/rpart-plot/index.html">rpart.plot</a></span><span class="op">)</span>

<span class="fu"><a href="https://rdrr.io/pkg/rattle/man/fancyRpartPlot.html">fancyRpartPlot</a></span><span class="op">(</span><span class="va">churn_model</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="07-decisiontree_files/figure-html/project-1.png" width="672"></div>
<div class="sourceCode" id="cb632"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">#predicting the model data based on the model built from training data set</span>
<span class="va">pred</span><span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span><span class="op">(</span><span class="va">churn_model</span>,<span class="va">testData</span>,type <span class="op">=</span> <span class="st">"class"</span> <span class="op">)</span>
<span class="va">pred</span></code></pre></div>
<pre><code>##    2    4    9   12   13   16   19   25   26   29   33   36   37   38   43   46 
##   no  yes   no   no   no  yes   no   no   no   no   no   no   no   no   no   no 
##   50   53   56   58   62   68   69   70   71   77   78   80   81   84   88   91 
##   no   no   no   no   no   no   no   no   no  yes  yes   no   no   no   no   no 
##   92   95   97   99  100  106  107  111  115  124  125  127  128  129  131  134 
##   no   no   no   no   no   no   no   no   no   no   no  yes   no   no   no   no 
##  135  141  142  150  156  158  159  161  162  164  165  171  172  176  177  183 
##   no   no   no   no   no   no   no   no   no   no   no   no   no   no   no   no 
##  189  194  196  203  206  210  218  223  228  238  242  244  249  250  255  261 
##   no   no   no   no   no   no   no   no   no   no  yes   no   no   no   no   no 
##  265  266  278  283  290  292  296  298  304  305  306  315  317  318  321  327 
##   no   no   no   no  yes   no   no   no   no   no  yes   no   no   no   no   no 
##  329  336  337  342  346  350  356  359  360  361  364  367  368  370  372  374 
##   no   no   no   no   no  yes   no   no   no   no   no   no   no   no   no   no 
##  382  383  389  396  397  398  399  401  403  406  407  412  414  417  418  424 
##   no   no   no   no   no  yes   no   no   no   no   no   no   no  yes   no   no 
##  425  431  432  433  434  438  440  444  446  448  449  452  453  454  455  458 
##   no  yes   no   no   no   no   no   no   no   no   no   no   no   no  yes   no 
##  460  463  464  467  468  469  476  477  479  483  486  499  501  503  504  508 
##   no   no   no   no   no   no   no   no   no   no   no  yes   no  yes   no   no 
##  512  515  517  519  527  531  538  541  548  549  550  553  554  556  561  562 
##   no   no   no   no   no   no   no   no  yes   no   no  yes   no   no   no   no 
##  564  565  567  568  569  571  573  574  576  577  578  581  584  590  593  601 
##   no   no   no   no  yes   no   no   no   no   no   no   no   no   no   no   no 
##  602  603  605  608  609  613  618  622  624  630  637  639  640  641  644  649 
##  yes   no   no   no   no  yes   no   no   no  yes   no   no   no   no   no   no 
##  653  656  657  660  663  664  665  669  670  678  679  682  684  697  703  705 
##   no  yes   no   no   no   no   no   no   no   no   no   no   no   no   no   no 
##  706  707  710  711  712  720  722  730  735  736  738  741  750  754  756  759 
##   no   no   no   no  yes   no  yes   no   no   no  yes   no   no   no   no   no 
##  762  763  764  767  769  772  773  780  782  783  785  786  787  793  797  798 
##   no   no   no  yes   no  yes   no   no   no   no   no   no   no   no   no  yes 
##  800  803  810  811  813  816  827  832  834  838  842  843  848  852  853  855 
##   no   no   no   no   no  yes   no   no   no   no   no   no   no   no   no   no 
##  859  861  863  869  870  878  882  884  888  890  891  892  894  897  898  899 
##   no   no   no   no   no  yes   no   no   no   no   no   no   no   no   no   no 
##  900  901  903  905  912  913  916  918  923  926  928  933  936  943  944  945 
##   no   no   no   no  yes   no   no   no   no   no   no   no   no   no   no   no 
##  955  961  964  965  968  971  974  976  982  983  984  989  995  996  997  998 
##   no   no   no   no   no   no   no  yes   no   no   no   no   no   no   no   no 
##  999 1000 1016 1019 1022 1030 1034 1035 1039 1041 1042 1043 1044 1048 1050 1052 
##   no   no   no   no   no   no   no   no  yes   no   no   no   no   no   no   no 
## 1054 1057 1061 1063 1065 1073 1082 1086 1087 1088 1093 1095 1100 1101 1105 1107 
##   no   no   no   no   no   no   no   no   no   no   no   no   no   no   no   no 
## 1117 1119 1123 1140 1149 1150 1151 1152 1155 1160 1173 1178 1182 1184 1186 1188 
##   no   no   no   no   no   no  yes   no   no   no   no   no   no   no   no   no 
## 1190 1191 1193 1194 1195 1196 1197 1199 1203 1206 1213 1218 1225 1227 1232 1235 
##   no   no   no  yes   no   no   no   no   no   no   no   no   no   no  yes   no 
## 1238 1240 1245 1249 1256 1257 1260 1261 1266 1268 1272 1280 1281 1284 1288 1298 
##   no   no   no   no   no   no   no   no   no   no   no   no   no   no   no   no 
## 1306 1307 1308 1309 1310 1312 1315 1316 1317 1320 1322 1325 1335 1336 1344 1351 
##   no   no   no   no   no   no   no   no   no   no   no   no  yes   no   no  yes 
## 1355 1356 1357 1360 1366 1367 1369 1373 1377 1381 1385 1388 1392 1396 1397 1398 
##   no   no   no   no   no   no   no   no   no   no   no   no   no   no   no   no 
## 1405 1408 1411 1413 1416 1417 1418 1419 1420 1421 1426 1427 1433 1442 1449 1454 
##   no  yes   no   no   no   no   no   no   no  yes   no   no   no   no   no   no 
## 1458 1459 1462 1463 1464 1471 1472 1473 1474 1478 1493 1500 1506 1512 1513 1516 
##   no   no   no   no   no   no   no  yes   no   no   no   no   no   no   no   no 
## 1517 1523 1528 1530 1537 1539 1542 1548 1550 1554 1556 1557 1564 1565 1570 1571 
##   no   no   no   no   no  yes   no   no   no   no   no   no   no   no   no   no 
## 1574 1575 1581 1584 1588 1590 1595 1596 1598 1600 1602 1609 1611 1612 1613 1614 
##   no   no   no   no   no   no   no   no   no   no   no   no  yes   no   no   no 
## 1616 1621 1625 1632 1635 1653 1655 1656 1660 1665 1689 1693 1694 1695 1703 1704 
##   no   no   no   no   no   no   no   no   no   no   no  yes   no  yes  yes   no 
## 1705 1707 1710 1711 1717 1723 1728 1729 1732 1736 1740 1743 1747 1750 1756 1757 
##  yes   no   no   no   no   no   no  yes  yes   no  yes   no   no   no   no   no 
## 1762 1764 1765 1769 1770 1771 1773 1775 1776 1791 1795 1797 1801 1802 1806 1807 
##   no   no  yes  yes   no   no   no   no   no   no  yes   no  yes   no   no   no 
## 1811 1815 1819 1820 1822 1823 1840 1842 1846 1847 1848 1854 1855 1862 1866 1868 
##   no   no   no   no   no   no   no   no  yes   no   no   no   no  yes  yes   no 
## 1871 1874 1875 1876 1880 1888 1890 1891 1893 1894 1895 1897 1904 1905 1907 1908 
##   no   no   no   no   no  yes   no   no  yes  yes   no   no  yes   no   no   no 
## 1910 1911 1913 1914 1915 1921 1922 1923 1926 1927 1930 1932 1944 1945 1948 1949 
##   no   no  yes   no   no   no   no  yes   no   no   no   no   no   no   no   no 
## 1954 1955 1957 1958 1959 1962 1963 1964 1967 1969 1973 1976 1982 1983 1987 1993 
##   no  yes   no   no   no   no   no   no   no   no   no   no   no   no   no   no 
## 1996 1998 1999 2002 2004 2008 2009 2017 2024 2025 2026 2031 2032 2034 2038 2051 
##   no   no   no   no   no   no   no   no   no   no   no   no  yes   no   no   no 
## 2054 2057 2060 2064 2071 2076 2079 2080 2085 2088 2097 2102 2109 2111 2112 2115 
##   no   no  yes   no   no   no   no   no   no  yes   no   no   no   no   no   no 
## 2117 2118 2119 2120 2121 2128 2129 2133 2136 2138 2139 2140 2143 2145 2147 2148 
##   no   no  yes   no   no   no   no   no   no   no   no   no   no   no   no   no 
## 2153 2156 2157 2158 2160 2161 2165 2166 2169 2172 2173 2175 2178 2179 2181 2183 
##   no  yes   no   no   no  yes  yes   no   no   no   no   no   no   no   no   no 
## 2186 2198 2203 2204 2205 2209 2210 2211 2217 2218 2222 2228 2231 2232 2235 2237 
##   no   no   no  yes   no   no   no  yes   no   no   no   no   no   no   no   no 
## 2240 2241 2248 2254 2265 2267 2269 2274 2276 2277 2280 2281 2282 2283 2285 2286 
##   no   no   no   no   no   no   no   no   no   no   no   no   no   no   no   no 
## 2290 2292 2294 2310 2312 2317 2318 2320 2326 2335 2337 2340 2341 2343 2345 2346 
##   no   no   no   no   no   no   no   no  yes   no   no   no   no   no   no   no 
## 2349 2353 2356 2359 2360 2361 2375 2376 2377 2379 2381 2386 2389 2391 2395 2402 
##   no   no   no   no   no   no   no   no  yes   no  yes   no  yes   no   no  yes 
## 2404 2406 2409 2411 2413 2420 2436 2437 2443 2446 2454 2458 2461 2463 2469 2471 
##   no   no   no   no  yes  yes   no   no   no   no   no   no   no   no  yes   no 
## 2474 2479 2480 2483 2487 2491 2493 2496 2498 2512 2514 2517 2522 2525 2526 2527 
##   no   no  yes   no   no   no   no   no   no   no   no   no   no   no   no  yes 
## 2530 2532 2533 2538 2540 2541 2550 2552 2553 2560 2561 2562 2563 2569 2572 2577 
##   no   no   no   no  yes   no   no   no   no   no   no   no   no   no   no   no 
## 2578 2588 2591 2592 2593 2599 2600 2604 2605 2606 2613 2618 2620 2624 2631 2633 
##   no   no   no  yes   no   no  yes   no   no   no   no   no  yes   no   no   no 
## 2635 2637 2638 2644 2645 2649 2650 2654 2656 2658 2664 2666 2668 2670 2672 2675 
##   no   no   no   no   no   no   no   no   no   no   no   no   no   no   no   no 
## 2678 2683 2689 2690 2696 2698 2708 2710 2711 2712 2713 2714 2717 2724 2728 2729 
##  yes   no   no   no   no   no   no   no  yes   no   no   no   no   no   no   no 
## 2730 2733 2738 2739 2741 2744 2745 2747 2749 2750 2751 2752 2753 2756 2760 2768 
##   no   no   no   no   no   no   no   no   no   no   no   no   no   no   no   no 
## 2769 2770 2771 2772 2774 2776 2782 2783 2785 2789 2790 2792 2793 2796 2823 2824 
##   no   no   no   no   no   no   no   no  yes  yes   no   no   no   no   no   no 
## 2825 2826 2827 2829 2830 2832 2834 2837 2839 2840 2841 2846 2849 2850 2852 2853 
##  yes   no   no  yes   no   no   no   no   no  yes   no   no   no   no   no   no 
## 2856 2862 2863 2865 2868 2871 2873 2874 2876 2878 2879 2883 2884 2886 2889 2890 
##   no   no   no   no   no   no   no   no   no   no   no  yes   no   no   no  yes 
## 2901 2904 2905 2906 2908 2916 2922 2924 2928 2929 2930 2931 2937 2938 2940 2943 
##   no   no   no   no   no   no   no   no   no   no   no   no   no   no   no  yes 
## 2945 2956 2957 2961 2962 2966 2973 2976 2979 2985 2986 2987 2988 2989 2990 2992 
##   no   no   no  yes   no   no   no   no   no   no   no   no  yes   no  yes   no 
## 2993 2994 2996 3002 3003 3007 3013 3017 3022 3028 3032 3034 3035 3036 3040 3041 
##   no   no   no   no  yes   no   no   no   no   no   no   no   no  yes   no   no 
## 3050 3051 3053 3060 3067 3070 3074 3080 3087 3103 3106 3111 3118 3120 3121 3122 
##   no  yes   no   no   no   no   no  yes   no   no   no   no   no   no   no   no 
## 3124 3126 3133 3135 3142 3146 3160 3161 3164 3170 3172 3174 3180 3184 3191 3192 
##   no   no  yes   no   no   no   no   no   no  yes   no   no   no   no   no   no 
## 3196 3198 3201 3204 3215 3218 3219 3221 3225 3231 3233 3234 3237 3240 3241 3243 
##   no   no   no   no   no   no   no   no  yes   no   no   no   no   no   no   no 
## 3247 3250 3255 3259 3271 3272 3273 3279 3287 3302 3306 3309 3311 3317 3319 3323 
##  yes   no   no   no   no   no  yes   no   no  yes   no   no   no   no   no  yes 
## 3328 3329 3330 3332 3333 3335 3341 3343 3347 3350 3351 3357 3359 3364 3365 3366 
##   no   no   no   no   no   no   no   no   no   no   no   no   no   no   no   no 
## 3367 3372 3376 3379 3380 3381 3382 3393 3394 3406 3418 3419 3421 3424 3425 3433 
##   no   no   no   no   no   no   no   no   no   no   no   no   no   no   no   no 
## 3435 3439 3442 3445 3450 3453 3454 3461 3462 3468 3473 3483 3484 3485 3491 3495 
##   no   no   no   no   no  yes   no   no  yes   no   no  yes   no   no   no  yes 
## 3497 3500 3505 3507 3509 3510 3517 3519 3520 3530 3531 3532 3549 3551 3570 3572 
##   no   no   no   no   no  yes   no   no   no   no   no   no  yes   no   no   no 
## 3576 3579 3580 3582 3583 3588 3594 3597 3599 3606 3607 3608 3618 3619 3622 3627 
##   no   no   no   no   no  yes   no   no   no   no   no   no  yes   no   no   no 
## 3632 3634 3635 3640 3643 3645 3651 3654 3655 3657 3658 3659 3661 3667 3675 3676 
##   no   no   no   no   no   no   no   no   no  yes   no   no   no   no   no  yes 
## 3679 3680 3681 3685 3687 3691 3693 3699 3704 3710 3717 3718 3722 3727 3731 3735 
##   no   no   no   no  yes   no  yes   no   no   no   no  yes   no   no   no   no 
## 3737 3742 3745 3750 3751 3754 3756 3758 3760 3762 3764 3769 3771 3772 3781 3785 
##   no   no   no   no   no   no   no   no   no   no   no   no   no   no   no   no 
## 3786 3787 3789 3793 3794 3798 3799 3802 3808 3810 3811 3815 3816 3819 3836 3842 
##   no   no   no   no   no   no   no   no   no   no   no   no   no   no   no   no 
## 3844 3845 3848 3853 3855 3858 3860 3862 3863 3866 3867 3871 3877 3882 3883 3885 
##   no   no  yes   no  yes   no   no   no   no   no   no   no   no   no   no   no 
## 3888 3889 3896 3897 3901 3902 3905 3907 3910 3911 3912 3914 3921 3923 3925 3933 
##   no   no   no   no   no  yes   no   no  yes   no   no   no   no   no   no   no 
## 3934 3937 3938 3943 3949 3951 3960 3962 3964 3968 3971 3977 3979 3982 3984 3985 
##   no   no   no   no   no   no   no   no   no   no   no   no  yes   no   no   no 
## 3990 3999 4004 4007 4008 4012 4015 4016 4018 4021 4024 4025 4029 4035 4042 4045 
##   no   no   no   no   no   no   no   no   no   no  yes   no   no   no   no   no 
## 4046 4065 4069 4070 4074 4077 4084 4087 4088 4097 4099 4100 4102 4105 4106 4107 
##   no   no   no   no   no   no   no   no  yes   no   no   no   no   no   no   no 
## 4109 4113 4117 4119 4121 4124 4131 4133 4135 4145 4156 4159 4163 4164 4168 4169 
##   no   no   no   no   no   no  yes  yes   no   no   no   no  yes   no   no   no 
## 4175 4179 4190 4193 4196 4198 4199 4206 4207 4210 4216 4218 4224 4228 4243 4244 
##   no   no   no   no   no   no   no   no   no   no   no   no   no   no   no   no 
## 4249 4264 4272 4278 4281 4287 4289 4290 4294 4297 4298 4302 4310 4311 4312 4318 
##   no   no   no   no   no   no   no   no   no  yes  yes   no  yes   no   no   no 
## 4319 4321 4322 4325 4327 4328 4334 4336 4338 4339 4341 4347 4353 4354 4355 4359 
##   no   no   no   no   no   no   no   no  yes   no   no   no   no   no   no   no 
## 4362 4367 4368 4370 4373 4374 4376 4378 4382 4388 4389 4391 4394 4395 4396 4399 
##   no  yes   no   no   no   no   no   no   no   no   no   no   no   no   no   no 
## 4400 4405 4407 4415 4416 4419 4423 4424 4430 4436 4439 4445 4451 4452 4454 4461 
##   no  yes   no   no   no   no   no   no   no   no   no   no   no   no   no   no 
## 4462 4463 4467 4469 4470 4471 4472 4473 4475 4478 4479 4480 4481 4485 4487 4490 
##   no   no   no   no   no   no  yes   no   no   no   no   no   no   no  yes   no 
## 4493 4494 4497 4502 4505 4508 4510 4511 4512 4513 4516 4517 4520 4522 4525 4527 
##  yes   no   no   no   no  yes   no   no   no   no   no   no   no   no   no   no 
## 4540 4545 4547 4554 4555 4563 4564 4567 4570 4574 4583 4589 4592 4594 4595 4598 
##   no   no   no   no   no  yes   no   no   no   no   no   no   no   no   no  yes 
## 4600 4604 4606 4609 4611 4612 4613 4614 4616 4617 4619 4623 4629 4642 4643 4644 
##  yes   no   no   no   no   no   no   no   no   no   no   no  yes   no   no  yes 
## 4650 4651 4652 4657 4660 4662 4663 4670 4674 4675 4681 4684 4687 4688 4690 4693 
##   no  yes   no   no   no   no   no   no   no   no   no   no   no  yes   no   no 
## 4694 4696 4698 4699 4703 4704 4708 4709 4710 4711 4714 4715 4719 4732 4735 4736 
##   no   no   no   no   no   no   no   no   no  yes   no   no   no   no   no   no 
## 4739 4740 4741 4743 4745 4754 4763 4766 4774 4775 4776 4777 4784 4785 4792 4795 
##   no   no  yes   no   no   no   no   no  yes   no   no   no   no   no   no   no 
## 4798 4800 4802 4803 4810 4830 4832 4835 4837 4838 4841 4848 4850 4852 4854 4858 
##   no   no   no   no  yes   no   no   no   no  yes   no   no   no   no   no   no 
## 4862 4864 4868 4874 4875 4876 4878 4879 4881 4889 4894 4897 4904 4909 4911 4914 
##  yes   no   no   no   no   no   no   no   no   no   no   no   no   no   no   no 
## 4915 4917 4918 4922 4923 4932 4934 4935 4937 4940 4941 4942 4943 4944 4947 4952 
##  yes   no  yes   no   no   no   no   no   no  yes   no   no   no  yes   no   no 
## 4954 4956 4960 4968 4969 4971 4973 4975 4982 4992 4995 5000 
##  yes   no  yes   no   no   no   no   no   no  yes   no   no 
## Levels: no yes</code></pre>
<div class="sourceCode" id="cb634"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">pred1</span><span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span><span class="va">pred</span><span class="op">)</span>
<span class="co">#View(pred1)</span>

<span class="co">#Confusion matrix is a technique for summarizing the performance of a classification algorithm </span>
<span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span><span class="va">testData</span><span class="op">$</span><span class="va">churn</span> ,<span class="va">pred</span><span class="op">)</span><span class="co">#create confusion matrix to see how mnay cus are correctly predicted and incorrectly predicted</span></code></pre></div>
<pre><code>##      pred
##         no  yes
##   no  1272   16
##   yes   64  148</code></pre>
<div class="sourceCode" id="cb636"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">#####</span>
<span class="co">#####RANDOM FOREST MODEL</span>
<span class="co">#####</span>


<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://www.stat.berkeley.edu/~breiman/RandomForests/">randomForest</a></span><span class="op">)</span></code></pre></div>
<pre><code>## randomForest 4.7-1.1</code></pre>
<pre><code>## Type rfNews() to see new features/changes/bug fixes.</code></pre>
<pre><code>## 
## Attaching package: 'randomForest'</code></pre>
<pre><code>## The following object is masked from 'package:rattle':
## 
##     importance</code></pre>
<div class="sourceCode" id="cb641"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">#to build the random forest model </span>
<span class="co">#trainData$churn = as.character(trainData$churn)</span>
<span class="va">random_model</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/randomForest/man/randomForest.html">randomForest</a></span><span class="op">(</span><span class="va">churn</span><span class="op">~</span><span class="va">.</span>,data<span class="op">=</span><span class="va">trainData</span>, importance <span class="op">=</span> <span class="cn">T</span><span class="op">)</span>
<span class="va">random_model</span></code></pre></div>
<pre><code>## 
## Call:
##  randomForest(formula = churn ~ ., data = trainData, importance = T) 
##                Type of random forest: classification
##                      Number of trees: 500
## No. of variables tried at each split: 4
## 
##         OOB estimate of  error rate: 4.51%
## Confusion matrix:
##       no yes class.error
## no  2977  28 0.009317804
## yes  130 365 0.262626263</code></pre>
<div class="sourceCode" id="cb643"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">#predicting the data based on the model developed</span>
<span class="va">ran_pred</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span><span class="op">(</span><span class="va">random_model</span>,<span class="va">testData</span><span class="op">)</span>
<span class="va">ran_pred</span></code></pre></div>
<pre><code>##    2    4    9   12   13   16   19   25   26   29   33   36   37   38   43   46 
##   no   no   no   no   no  yes   no   no   no   no   no   no   no   no   no   no 
##   50   53   56   58   62   68   69   70   71   77   78   80   81   84   88   91 
##   no   no   no   no   no   no   no   no   no  yes  yes   no   no   no   no   no 
##   92   95   97   99  100  106  107  111  115  124  125  127  128  129  131  134 
##   no   no   no   no   no   no   no   no   no   no   no  yes   no   no   no   no 
##  135  141  142  150  156  158  159  161  162  164  165  171  172  176  177  183 
##   no   no   no   no   no   no   no   no   no   no   no   no   no   no   no   no 
##  189  194  196  203  206  210  218  223  228  238  242  244  249  250  255  261 
##   no   no   no   no   no   no   no   no   no   no  yes   no   no   no   no   no 
##  265  266  278  283  290  292  296  298  304  305  306  315  317  318  321  327 
##   no   no   no   no  yes   no   no   no   no   no   no   no   no   no   no   no 
##  329  336  337  342  346  350  356  359  360  361  364  367  368  370  372  374 
##   no   no   no   no   no  yes   no   no   no  yes   no   no   no   no   no   no 
##  382  383  389  396  397  398  399  401  403  406  407  412  414  417  418  424 
##   no   no   no   no   no  yes   no   no   no   no   no   no   no  yes   no   no 
##  425  431  432  433  434  438  440  444  446  448  449  452  453  454  455  458 
##   no  yes   no   no   no  yes   no   no   no   no   no   no   no   no  yes   no 
##  460  463  464  467  468  469  476  477  479  483  486  499  501  503  504  508 
##   no   no   no   no   no   no   no   no   no   no   no   no   no  yes   no   no 
##  512  515  517  519  527  531  538  541  548  549  550  553  554  556  561  562 
##   no  yes   no   no   no   no   no   no  yes   no   no  yes   no   no   no   no 
##  564  565  567  568  569  571  573  574  576  577  578  581  584  590  593  601 
##   no   no   no   no  yes   no   no   no   no   no   no   no   no   no   no   no 
##  602  603  605  608  609  613  618  622  624  630  637  639  640  641  644  649 
##  yes   no   no   no   no  yes   no   no   no  yes   no   no   no   no   no   no 
##  653  656  657  660  663  664  665  669  670  678  679  682  684  697  703  705 
##   no  yes   no   no   no   no   no   no   no   no   no   no   no   no   no   no 
##  706  707  710  711  712  720  722  730  735  736  738  741  750  754  756  759 
##   no   no   no   no   no   no  yes   no   no   no  yes   no   no   no   no   no 
##  762  763  764  767  769  772  773  780  782  783  785  786  787  793  797  798 
##   no   no   no  yes   no  yes   no   no   no   no   no   no   no   no   no  yes 
##  800  803  810  811  813  816  827  832  834  838  842  843  848  852  853  855 
##   no   no   no   no   no  yes   no   no   no   no   no   no   no   no   no   no 
##  859  861  863  869  870  878  882  884  888  890  891  892  894  897  898  899 
##   no   no   no   no   no   no   no   no   no   no   no   no   no   no   no   no 
##  900  901  903  905  912  913  916  918  923  926  928  933  936  943  944  945 
##   no   no   no  yes  yes   no   no   no   no   no   no   no   no   no   no  yes 
##  955  961  964  965  968  971  974  976  982  983  984  989  995  996  997  998 
##   no   no   no   no   no   no   no  yes   no   no   no   no   no   no   no   no 
##  999 1000 1016 1019 1022 1030 1034 1035 1039 1041 1042 1043 1044 1048 1050 1052 
##   no   no   no  yes   no   no   no   no  yes   no   no   no   no   no   no   no 
## 1054 1057 1061 1063 1065 1073 1082 1086 1087 1088 1093 1095 1100 1101 1105 1107 
##   no   no   no   no   no   no   no   no   no   no   no   no   no   no   no   no 
## 1117 1119 1123 1140 1149 1150 1151 1152 1155 1160 1173 1178 1182 1184 1186 1188 
##   no   no   no   no   no   no  yes   no   no   no   no   no   no   no   no   no 
## 1190 1191 1193 1194 1195 1196 1197 1199 1203 1206 1213 1218 1225 1227 1232 1235 
##   no   no  yes  yes   no   no   no   no   no   no   no   no   no   no  yes   no 
## 1238 1240 1245 1249 1256 1257 1260 1261 1266 1268 1272 1280 1281 1284 1288 1298 
##   no   no   no   no   no   no   no   no   no   no   no   no   no   no   no   no 
## 1306 1307 1308 1309 1310 1312 1315 1316 1317 1320 1322 1325 1335 1336 1344 1351 
##   no   no   no   no   no   no   no   no   no   no   no   no  yes   no   no  yes 
## 1355 1356 1357 1360 1366 1367 1369 1373 1377 1381 1385 1388 1392 1396 1397 1398 
##   no   no   no   no   no   no   no   no  yes   no   no   no   no   no   no   no 
## 1405 1408 1411 1413 1416 1417 1418 1419 1420 1421 1426 1427 1433 1442 1449 1454 
##   no  yes   no   no   no   no   no   no   no  yes   no   no   no   no   no   no 
## 1458 1459 1462 1463 1464 1471 1472 1473 1474 1478 1493 1500 1506 1512 1513 1516 
##   no   no   no   no   no   no   no  yes   no   no   no   no   no   no   no   no 
## 1517 1523 1528 1530 1537 1539 1542 1548 1550 1554 1556 1557 1564 1565 1570 1571 
##   no   no   no   no   no  yes   no   no   no   no   no   no   no   no   no   no 
## 1574 1575 1581 1584 1588 1590 1595 1596 1598 1600 1602 1609 1611 1612 1613 1614 
##   no   no   no   no   no   no   no   no   no   no  yes   no   no   no   no   no 
## 1616 1621 1625 1632 1635 1653 1655 1656 1660 1665 1689 1693 1694 1695 1703 1704 
##   no   no   no   no   no   no   no   no   no   no   no  yes   no  yes  yes   no 
## 1705 1707 1710 1711 1717 1723 1728 1729 1732 1736 1740 1743 1747 1750 1756 1757 
##  yes   no   no   no   no   no   no  yes  yes   no  yes   no   no   no   no   no 
## 1762 1764 1765 1769 1770 1771 1773 1775 1776 1791 1795 1797 1801 1802 1806 1807 
##   no   no  yes  yes   no   no   no   no   no   no  yes   no   no   no   no   no 
## 1811 1815 1819 1820 1822 1823 1840 1842 1846 1847 1848 1854 1855 1862 1866 1868 
##   no   no   no   no   no   no   no   no  yes   no   no   no   no  yes  yes   no 
## 1871 1874 1875 1876 1880 1888 1890 1891 1893 1894 1895 1897 1904 1905 1907 1908 
##   no   no   no   no   no  yes   no   no  yes  yes   no   no  yes   no   no   no 
## 1910 1911 1913 1914 1915 1921 1922 1923 1926 1927 1930 1932 1944 1945 1948 1949 
##   no   no  yes   no   no   no   no   no   no   no   no   no   no   no   no   no 
## 1954 1955 1957 1958 1959 1962 1963 1964 1967 1969 1973 1976 1982 1983 1987 1993 
##   no  yes   no   no   no   no   no   no   no   no   no   no   no   no   no   no 
## 1996 1998 1999 2002 2004 2008 2009 2017 2024 2025 2026 2031 2032 2034 2038 2051 
##   no   no   no  yes   no   no   no   no   no   no   no   no  yes   no   no   no 
## 2054 2057 2060 2064 2071 2076 2079 2080 2085 2088 2097 2102 2109 2111 2112 2115 
##   no   no  yes   no   no   no   no   no   no  yes   no   no   no   no   no   no 
## 2117 2118 2119 2120 2121 2128 2129 2133 2136 2138 2139 2140 2143 2145 2147 2148 
##   no   no  yes   no   no   no   no   no   no   no   no   no   no   no   no   no 
## 2153 2156 2157 2158 2160 2161 2165 2166 2169 2172 2173 2175 2178 2179 2181 2183 
##   no  yes   no   no   no  yes  yes   no   no   no   no   no   no   no   no   no 
## 2186 2198 2203 2204 2205 2209 2210 2211 2217 2218 2222 2228 2231 2232 2235 2237 
##   no   no   no  yes   no   no   no  yes   no   no   no   no   no   no   no   no 
## 2240 2241 2248 2254 2265 2267 2269 2274 2276 2277 2280 2281 2282 2283 2285 2286 
##   no   no   no   no   no   no   no   no   no   no   no   no   no   no   no   no 
## 2290 2292 2294 2310 2312 2317 2318 2320 2326 2335 2337 2340 2341 2343 2345 2346 
##   no   no   no   no   no   no   no   no  yes   no   no   no   no   no   no   no 
## 2349 2353 2356 2359 2360 2361 2375 2376 2377 2379 2381 2386 2389 2391 2395 2402 
##   no   no   no   no   no   no   no   no  yes   no   no   no  yes   no   no  yes 
## 2404 2406 2409 2411 2413 2420 2436 2437 2443 2446 2454 2458 2461 2463 2469 2471 
##   no   no   no   no  yes   no   no   no   no   no   no   no   no   no  yes   no 
## 2474 2479 2480 2483 2487 2491 2493 2496 2498 2512 2514 2517 2522 2525 2526 2527 
##   no   no  yes   no   no   no   no   no   no   no   no   no   no   no   no  yes 
## 2530 2532 2533 2538 2540 2541 2550 2552 2553 2560 2561 2562 2563 2569 2572 2577 
##   no   no   no   no  yes   no   no   no   no   no   no   no   no   no   no   no 
## 2578 2588 2591 2592 2593 2599 2600 2604 2605 2606 2613 2618 2620 2624 2631 2633 
##   no   no   no  yes   no   no  yes   no   no   no   no   no  yes   no   no   no 
## 2635 2637 2638 2644 2645 2649 2650 2654 2656 2658 2664 2666 2668 2670 2672 2675 
##   no   no   no   no   no   no   no   no   no   no   no   no   no   no   no   no 
## 2678 2683 2689 2690 2696 2698 2708 2710 2711 2712 2713 2714 2717 2724 2728 2729 
##  yes   no   no   no   no   no   no   no  yes   no   no   no   no   no   no   no 
## 2730 2733 2738 2739 2741 2744 2745 2747 2749 2750 2751 2752 2753 2756 2760 2768 
##   no  yes   no   no   no   no   no   no   no   no   no   no   no   no   no   no 
## 2769 2770 2771 2772 2774 2776 2782 2783 2785 2789 2790 2792 2793 2796 2823 2824 
##   no   no   no   no   no   no   no   no   no   no   no   no   no   no   no   no 
## 2825 2826 2827 2829 2830 2832 2834 2837 2839 2840 2841 2846 2849 2850 2852 2853 
##  yes   no   no  yes   no   no   no   no   no  yes   no   no   no   no   no   no 
## 2856 2862 2863 2865 2868 2871 2873 2874 2876 2878 2879 2883 2884 2886 2889 2890 
##   no   no   no   no   no   no   no   no   no   no   no  yes   no   no   no  yes 
## 2901 2904 2905 2906 2908 2916 2922 2924 2928 2929 2930 2931 2937 2938 2940 2943 
##   no   no   no   no   no   no   no   no   no   no   no   no  yes   no   no  yes 
## 2945 2956 2957 2961 2962 2966 2973 2976 2979 2985 2986 2987 2988 2989 2990 2992 
##   no   no   no  yes  yes   no   no   no   no   no   no   no  yes   no  yes   no 
## 2993 2994 2996 3002 3003 3007 3013 3017 3022 3028 3032 3034 3035 3036 3040 3041 
##   no   no   no   no  yes   no   no   no   no   no   no   no   no  yes   no   no 
## 3050 3051 3053 3060 3067 3070 3074 3080 3087 3103 3106 3111 3118 3120 3121 3122 
##   no  yes   no   no   no   no   no  yes   no   no   no   no   no   no   no   no 
## 3124 3126 3133 3135 3142 3146 3160 3161 3164 3170 3172 3174 3180 3184 3191 3192 
##   no   no  yes   no   no   no   no   no   no  yes   no   no   no   no   no   no 
## 3196 3198 3201 3204 3215 3218 3219 3221 3225 3231 3233 3234 3237 3240 3241 3243 
##   no   no   no   no   no   no   no   no  yes   no   no   no   no   no   no   no 
## 3247 3250 3255 3259 3271 3272 3273 3279 3287 3302 3306 3309 3311 3317 3319 3323 
##  yes   no   no   no   no   no  yes   no   no  yes   no   no   no   no   no  yes 
## 3328 3329 3330 3332 3333 3335 3341 3343 3347 3350 3351 3357 3359 3364 3365 3366 
##   no   no   no   no   no   no   no   no   no   no   no   no   no   no   no   no 
## 3367 3372 3376 3379 3380 3381 3382 3393 3394 3406 3418 3419 3421 3424 3425 3433 
##   no   no   no   no   no   no   no   no   no   no   no   no   no   no   no   no 
## 3435 3439 3442 3445 3450 3453 3454 3461 3462 3468 3473 3483 3484 3485 3491 3495 
##   no   no   no   no   no  yes   no   no  yes   no   no  yes   no   no   no  yes 
## 3497 3500 3505 3507 3509 3510 3517 3519 3520 3530 3531 3532 3549 3551 3570 3572 
##   no   no   no   no   no  yes   no   no   no   no   no   no  yes   no   no   no 
## 3576 3579 3580 3582 3583 3588 3594 3597 3599 3606 3607 3608 3618 3619 3622 3627 
##   no   no   no   no   no  yes   no   no   no   no   no   no  yes   no   no   no 
## 3632 3634 3635 3640 3643 3645 3651 3654 3655 3657 3658 3659 3661 3667 3675 3676 
##   no   no   no   no   no   no   no   no   no  yes   no   no   no   no   no  yes 
## 3679 3680 3681 3685 3687 3691 3693 3699 3704 3710 3717 3718 3722 3727 3731 3735 
##   no   no   no   no  yes   no  yes   no   no   no   no  yes   no   no   no   no 
## 3737 3742 3745 3750 3751 3754 3756 3758 3760 3762 3764 3769 3771 3772 3781 3785 
##   no   no   no   no   no   no   no   no   no   no   no   no   no   no   no   no 
## 3786 3787 3789 3793 3794 3798 3799 3802 3808 3810 3811 3815 3816 3819 3836 3842 
##   no   no   no   no   no   no   no   no   no   no   no   no   no   no   no   no 
## 3844 3845 3848 3853 3855 3858 3860 3862 3863 3866 3867 3871 3877 3882 3883 3885 
##   no   no  yes  yes  yes   no   no   no   no   no   no   no   no   no   no   no 
## 3888 3889 3896 3897 3901 3902 3905 3907 3910 3911 3912 3914 3921 3923 3925 3933 
##   no   no   no   no   no  yes   no   no  yes   no   no   no   no   no   no   no 
## 3934 3937 3938 3943 3949 3951 3960 3962 3964 3968 3971 3977 3979 3982 3984 3985 
##   no   no   no   no   no   no   no   no   no   no   no   no  yes   no   no   no 
## 3990 3999 4004 4007 4008 4012 4015 4016 4018 4021 4024 4025 4029 4035 4042 4045 
##   no   no   no   no   no   no   no   no   no   no  yes   no   no   no  yes   no 
## 4046 4065 4069 4070 4074 4077 4084 4087 4088 4097 4099 4100 4102 4105 4106 4107 
##   no   no   no   no   no   no   no   no  yes   no   no   no   no   no   no   no 
## 4109 4113 4117 4119 4121 4124 4131 4133 4135 4145 4156 4159 4163 4164 4168 4169 
##   no   no   no   no   no   no  yes   no   no   no   no   no  yes   no   no   no 
## 4175 4179 4190 4193 4196 4198 4199 4206 4207 4210 4216 4218 4224 4228 4243 4244 
##   no   no   no   no   no   no   no   no   no   no   no   no   no   no   no   no 
## 4249 4264 4272 4278 4281 4287 4289 4290 4294 4297 4298 4302 4310 4311 4312 4318 
##   no   no   no   no   no   no   no   no   no  yes  yes   no  yes   no   no   no 
## 4319 4321 4322 4325 4327 4328 4334 4336 4338 4339 4341 4347 4353 4354 4355 4359 
##   no   no   no   no   no   no   no   no  yes   no   no   no   no   no   no   no 
## 4362 4367 4368 4370 4373 4374 4376 4378 4382 4388 4389 4391 4394 4395 4396 4399 
##   no  yes   no   no   no   no   no   no   no   no   no   no   no   no   no   no 
## 4400 4405 4407 4415 4416 4419 4423 4424 4430 4436 4439 4445 4451 4452 4454 4461 
##   no  yes  yes   no   no   no   no   no   no   no   no   no   no   no   no   no 
## 4462 4463 4467 4469 4470 4471 4472 4473 4475 4478 4479 4480 4481 4485 4487 4490 
##   no   no   no   no   no   no  yes   no   no   no   no   no   no   no   no  yes 
## 4493 4494 4497 4502 4505 4508 4510 4511 4512 4513 4516 4517 4520 4522 4525 4527 
##  yes   no   no   no   no  yes   no   no   no   no   no   no   no   no   no   no 
## 4540 4545 4547 4554 4555 4563 4564 4567 4570 4574 4583 4589 4592 4594 4595 4598 
##   no   no   no   no   no  yes   no   no   no   no   no   no   no   no   no  yes 
## 4600 4604 4606 4609 4611 4612 4613 4614 4616 4617 4619 4623 4629 4642 4643 4644 
##  yes   no   no   no   no   no   no   no   no   no   no   no  yes   no   no  yes 
## 4650 4651 4652 4657 4660 4662 4663 4670 4674 4675 4681 4684 4687 4688 4690 4693 
##   no  yes   no   no   no   no   no   no   no   no   no   no   no  yes   no   no 
## 4694 4696 4698 4699 4703 4704 4708 4709 4710 4711 4714 4715 4719 4732 4735 4736 
##   no   no   no   no   no   no   no   no   no  yes   no   no   no   no   no   no 
## 4739 4740 4741 4743 4745 4754 4763 4766 4774 4775 4776 4777 4784 4785 4792 4795 
##   no   no  yes   no   no   no   no   no  yes   no   no  yes   no   no   no   no 
## 4798 4800 4802 4803 4810 4830 4832 4835 4837 4838 4841 4848 4850 4852 4854 4858 
##   no   no   no   no  yes   no   no   no   no  yes   no   no   no   no   no   no 
## 4862 4864 4868 4874 4875 4876 4878 4879 4881 4889 4894 4897 4904 4909 4911 4914 
##  yes   no   no   no   no   no   no   no   no   no   no   no   no   no   no   no 
## 4915 4917 4918 4922 4923 4932 4934 4935 4937 4940 4941 4942 4943 4944 4947 4952 
##  yes   no  yes   no   no   no   no   no   no  yes   no   no   no  yes   no   no 
## 4954 4956 4960 4968 4969 4971 4973 4975 4982 4992 4995 5000 
##  yes   no  yes   no   no   no   no   no   no  yes   no   no 
## Levels: no yes</code></pre>
<div class="sourceCode" id="cb645"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">ran_pred1</span> <span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span><span class="va">ran_pred</span><span class="op">)</span>

<span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span><span class="va">testData</span><span class="op">$</span><span class="va">churn</span> ,<span class="va">ran_pred</span><span class="op">)</span> <span class="co"># confusion matrix</span></code></pre></div>
<pre><code>##      ran_pred
##         no  yes
##   no  1282    6
##   yes   50  162</code></pre>
<div class="sourceCode" id="cb647"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">#accuracy rate </span>
<span class="op">(</span><span class="fl">1276</span><span class="op">+</span> <span class="fl">173</span><span class="op">)</span><span class="op">/</span><span class="op">(</span><span class="fl">1276</span><span class="op">+</span><span class="fl">12</span><span class="op">+</span><span class="fl">39</span><span class="op">+</span><span class="fl">173</span><span class="op">)</span> <span class="co"># 97 % of accuracy : higher than decision tree , where accuracy rate is 95 % </span></code></pre></div>
<pre><code>## [1] 0.966</code></pre>
<div class="sourceCode" id="cb649"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">#most commonly mean decrease gini is considered</span>
<span class="fu"><a href="https://rdrr.io/pkg/randomForest/man/importance.html">importance</a></span><span class="op">(</span><span class="va">random_model</span><span class="op">)</span></code></pre></div>
<pre><code>##                                       no         yes MeanDecreaseAccuracy
## international_plan            71.6786627  81.0854662          86.75733745
## voice_mail_plan               17.5649360  21.6852537          21.95585067
## number_vmail_messages         17.5526580  23.6918646          23.45731299
## total_day_minutes             32.1444221  33.3700120          40.84763576
## total_day_calls               -0.7332284  -0.2622289          -0.74726915
## total_day_charge              33.5784834  37.0647034          44.02444058
## total_eve_minutes             23.5651706  23.2723158          27.45138323
## total_eve_calls               -0.3764121  -2.8852315          -1.50063960
## total_eve_charge              24.8277482  20.4497983          28.80630514
## total_night_minutes           20.9917001   6.6569779          22.30739224
## total_night_calls             -0.7637893   1.6614653          -0.06663555
## total_night_charge            21.0935599   7.0747248          22.38821347
## total_intl_minutes            24.4909233  20.0682927          29.10870917
## total_intl_calls              33.7922896  46.9570237          48.07341347
## total_intl_charge             22.8484086  19.5347150          26.74798164
## number_customer_service_calls 76.6916632 100.1333436         104.12122334
##                               MeanDecreaseGini
## international_plan                    71.45281
## voice_mail_plan                       16.07021
## number_vmail_messages                 24.02874
## total_day_minutes                    120.74606
## total_day_calls                       25.11515
## total_day_charge                     128.74458
## total_eve_minutes                     56.09157
## total_eve_calls                       23.02050
## total_eve_charge                      57.74668
## total_night_minutes                   38.44003
## total_night_calls                     26.43272
## total_night_charge                    37.95753
## total_intl_minutes                    39.41497
## total_intl_calls                      45.68021
## total_intl_charge                     39.44432
## number_customer_service_calls         98.06230</code></pre>
<div class="sourceCode" id="cb651"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Variables that result in nodes with higher purity have a higher decrease in Gini coefficient.</span>
<span class="fu"><a href="https://rdrr.io/pkg/randomForest/man/varImpPlot.html">varImpPlot</a></span><span class="op">(</span><span class="va">random_model</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="07-decisiontree_files/figure-html/project-2.png" width="672"></div>
<div class="sourceCode" id="cb652"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">#total day charges have higher decrease in gini index so its more significant than other</span></code></pre></div>

</div>
</div>
  <div class="chapter-nav">
<div class="prev"><a href="logistic%E5%9B%9E%E5%BD%92.html"><span class="header-section-number">7</span> Logistic回归</a></div>
<div class="next"><a href="%E6%94%AF%E6%8C%81%E5%90%91%E9%87%8F%E6%9C%BA%E5%92%8C%E7%A5%9E%E7%BB%8F%E7%BD%91%E7%BB%9C.html"><span class="header-section-number">9</span> 支持向量机和神经网络</a></div>
</div></main><div class="col-md-3 col-lg-2 d-none d-md-block sidebar sidebar-chapter">
    <nav id="toc" data-toggle="toc" aria-label="On this page"><h2>On this page</h2>
      <ul class="nav navbar-nav">
<li><a class="nav-link" href="#%E5%86%B3%E7%AD%96%E6%A0%91%E5%8F%8A%E5%85%B6%E7%BB%84%E5%90%88%E6%96%B9%E6%B3%95"><span class="header-section-number">8</span> 决策树及其组合方法</a></li>
<li><a class="nav-link" href="#%E5%86%B3%E7%AD%96%E6%A0%91"><span class="header-section-number">8.1</span> 决策树</a></li>
<li><a class="nav-link" href="#%E5%AE%9E%E4%BE%8B-1"><span class="header-section-number">8.2</span> 实例</a></li>
</ul>

      <div class="book-extra">
        <ul class="list-unstyled">
          
        </ul>
</div>
    </nav>
</div>

</div>
</div> <!-- .container -->

<footer class="bg-primary text-light mt-5"><div class="container"><div class="row">

  <div class="col-12 col-md-6 mt-3">
    <p>"<strong>数据科学导论（Introductory of Data Science）</strong>" was written by 潘蓄林. It was last built on 2022-06-08.</p>
  </div>

  <div class="col-12 col-md-6 mt-3">
    <p>This book was built by the <a class="text-light" href="https://bookdown.org">bookdown</a> R package.</p>
  </div>

</div></div>
</footer><!-- dynamically load mathjax for compatibility with self-contained --><script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script><script type="text/x-mathjax-config">const popovers = document.querySelectorAll('a.footnote-ref[data-toggle="popover"]');
for (let popover of popovers) {
  const div = document.createElement('div');
  div.setAttribute('style', 'position: absolute; top: 0, left:0; width:0, height:0, overflow: hidden; visibility: hidden;');
  div.innerHTML = popover.getAttribute('data-content');

  var has_math = div.querySelector("span.math");
  if (has_math) {
    document.body.appendChild(div);
    MathJax.Hub.Queue(["Typeset", MathJax.Hub, div]);
    MathJax.Hub.Queue(function() {
      popover.setAttribute('data-content', div.innerHTML);
      document.body.removeChild(div);
    })
  }
}
</script>
</body>
</html>
